<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RecruitCRM Media Dashboard | 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-card: #ffffff;
            --bg-hover: #f8fafc;
            --accent-primary: #2563eb;
            --accent-secondary: #3b82f6;
            --accent-success: #059669;
            --accent-warning: #d97706;
            --accent-danger: #dc2626;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --border-focus: #2563eb;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .layout { display: flex; min-height: 100vh; }

        /* Sidebar */
        .sidebar {
            width: 240px;
            background: var(--bg-primary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            z-index: 100;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .logo-section { display: flex; align-items: center; gap: 12px; }

        .logo {
            width: 36px; height: 36px;
            background: var(--accent-primary);
            border-radius: var(--radius-md);
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 16px; color: white;
        }

        .logo-text { font-size: 15px; font-weight: 600; }
        .logo-subtitle { font-size: 11px; color: var(--text-muted); }

        .sidebar-content { flex: 1; overflow-y: auto; padding: 16px; }

        .sidebar-section { margin-bottom: 24px; }

        .sidebar-section-title {
            font-size: 11px; font-weight: 600; color: var(--text-muted);
            text-transform: uppercase; letter-spacing: 0.05em;
            padding: 0 12px; margin-bottom: 8px;
        }

        /* Period Tabs - Overview + Months */
        .period-tabs {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            overflow-x: auto;
            margin-bottom: 20px;
        }

        .period-tab {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 10px 16px;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.15s;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            border: none;
            background: transparent;
            font-family: inherit;
            white-space: nowrap;
        }

        .period-tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .period-tab.active {
            background: var(--bg-primary);
            color: var(--accent-primary);
            box-shadow: var(--shadow-sm);
        }

        .period-tab.overview {
            font-weight: 600;
        }

        .period-tab.overview.active {
            background: var(--accent-primary);
            color: white;
        }

        .period-tab-icon {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .period-tab .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--accent-success);
        }

        .period-tab.disabled {
            color: var(--text-muted);
            cursor: not-allowed;
            opacity: 0.5;
        }

        .period-tab.disabled .status-dot {
            background: var(--border-color);
        }

        .pod-list { display: flex; flex-direction: column; gap: 2px; }

        .pod-item {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 12px; border-radius: var(--radius-md);
            cursor: pointer; transition: all 0.15s;
            font-size: 14px; color: var(--text-secondary);
            border: none; background: transparent;
            width: 100%; text-align: left; font-family: inherit;
        }

        .pod-item:hover { background: var(--bg-tertiary); color: var(--text-primary); }
        .pod-item.active { background: #eff6ff; color: var(--accent-primary); font-weight: 500; }

        .pod-icon {
            width: 28px; height: 28px;
            border-radius: var(--radius-sm);
            display: flex; align-items: center; justify-content: center;
            font-size: 12px;
        }

        .pod-icon.all { background: #f1f5f9; color: #64748b; }
        .pod-icon.awareness { background: #fef3c7; color: #d97706; }
        .pod-icon.brand { background: #fce7f3; color: #db2777; }
        .pod-icon.conversion { background: #d1fae5; color: #059669; }
        .pod-icon.untracked { background: #e2e8f0; color: #64748b; }
        .pod-icon.leadership { background: #fef3c7; color: #b45309; }
        .pod-icon.outbound { background: #e0e7ff; color: #4f46e5; }

        /* Leadership Dashboard Styles */
        .leadership-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .leadership-subtitle {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 24px;
        }

        .leadership-section {
            margin-bottom: 32px;
        }

        .leadership-section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .pod-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .pod-badge.awareness { background: #fef3c7; color: #d97706; }
        .pod-badge.brand { background: #fce7f3; color: #db2777; }
        .pod-badge.conversion { background: #d1fae5; color: #059669; }
        .pod-badge.untracked { background: #e2e8f0; color: #64748b; }

        .pod-totals-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .pod-total-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            transition: all 0.2s;
        }

        .pod-total-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .pod-total-card.awareness { border-left: 4px solid #d97706; }
        .pod-total-card.brand { border-left: 4px solid #db2777; }
        .pod-total-card.conversion { border-left: 4px solid #059669; }
        .pod-total-card.untracked { border-left: 4px solid #64748b; }

        .pod-total-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
        }

        .pod-total-icon {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pod-total-icon.awareness { background: #fef3c7; color: #d97706; }
        .pod-total-icon.brand { background: #fce7f3; color: #db2777; }
        .pod-total-icon.conversion { background: #d1fae5; color: #059669; }
        .pod-total-icon.untracked { background: #e2e8f0; color: #64748b; }

        .pod-total-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .pod-total-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .pod-metric {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .pod-metric-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .pod-metric-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .channel-pod-cell {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .empty-state {
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            min-height: calc(100vh - 130px);
            padding: 48px; text-align: center;
        }

        .empty-state-icon {
            width: 80px; height: 80px;
            background: var(--bg-tertiary);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 24px; color: var(--text-muted);
        }

        .empty-state-icon svg { width: 36px; height: 36px; }

        .empty-state-title {
            font-size: 20px; font-weight: 600;
            color: var(--text-primary); margin-bottom: 8px;
        }

        .empty-state-text {
            font-size: 14px; color: var(--text-muted);
            max-width: 400px; line-height: 1.6;
        }

        .sidebar-footer { padding: 16px; border-top: 1px solid var(--border-color); }

        .connection-status {
            display: flex; align-items: center; gap: 8px;
            font-size: 12px; color: var(--text-muted);
            padding: 10px 12px; background: var(--bg-tertiary);
            border-radius: var(--radius-md);
        }

        .status-indicator { width: 8px; height: 8px; border-radius: 50%; background: var(--accent-success); }
        .status-indicator.error { background: var(--accent-danger); }
        .status-indicator.loading { background: var(--accent-warning); animation: pulse 1.5s infinite; }

        .refresh-info {
            display: flex; flex-direction: column; gap: 4px;
            padding: 10px 12px; background: var(--bg-tertiary);
            border-radius: var(--radius-md); margin-top: 8px;
        }

        .refresh-row {
            display: flex; align-items: center; justify-content: space-between;
            font-size: 11px; color: var(--text-muted);
        }

        .refresh-label { font-weight: 500; }
        .refresh-value { font-family: 'Inter', sans-serif; color: var(--text-secondary); }
        .refresh-countdown { color: var(--accent-primary); font-weight: 600; }

        .refresh-btn {
            display: flex; align-items: center; justify-content: center; gap: 8px;
            width: 100%; padding: 10px 16px; margin-top: 12px;
            background: var(--accent-primary); color: white;
            border: none; border-radius: var(--radius-md);
            font-size: 13px; font-weight: 500; font-family: inherit;
            cursor: pointer; transition: all 0.15s;
        }

        .refresh-btn:hover { background: #1d4ed8; }
        .refresh-btn:disabled { opacity: 0.7; cursor: not-allowed; }
        .refresh-btn .spinning { animation: spin 1s linear infinite; display: flex; }

        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

        /* Main Content */
        .main-content { flex: 1; margin-left: 240px; min-height: 100vh; }

        .topbar {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: 16px 32px;
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 50;
        }

        .page-title { font-size: 20px; font-weight: 600; }

        .topbar-right { display: flex; align-items: center; gap: 12px; }

        .btn {
            padding: 8px 16px; border-radius: var(--radius-md);
            font-size: 13px; font-family: inherit; font-weight: 500;
            cursor: pointer; display: flex; align-items: center; gap: 6px;
            transition: all 0.15s; border: none;
        }

        .btn-primary { background: var(--accent-primary); color: white; }
        .btn-primary:hover { background: #1d4ed8; }

        .btn-secondary {
            background: var(--bg-primary); color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover { background: var(--bg-tertiary); }

        .btn-icon {
            width: 36px; height: 36px; padding: 0;
            display: flex; align-items: center; justify-content: center;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
            background: var(--bg-primary); color: var(--text-secondary);
            cursor: pointer; transition: all 0.15s;
        }

        .btn-icon:hover { background: var(--bg-tertiary); color: var(--text-primary); }
        .btn-icon.spinning svg { animation: spin 1s linear infinite; }

        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Filter Bar */
        .filter-bar {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: 12px 32px;
            display: flex; align-items: center; gap: 16px; flex-wrap: wrap;
        }

        .filter-group { display: flex; align-items: center; gap: 8px; }

        .filter-label { font-size: 13px; color: var(--text-muted); font-weight: 500; }

        .filter-select {
            padding: 8px 32px 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: 13px; font-family: inherit;
            color: var(--text-primary); background: var(--bg-primary);
            cursor: pointer; appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            min-width: 140px;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--border-focus);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .content-area { padding: 24px 32px; }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px; margin-bottom: 24px;
        }

        .summary-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            transition: all 0.2s;
        }

        .summary-card:hover { box-shadow: var(--shadow-md); }

        .summary-icon {
            width: 40px; height: 40px;
            border-radius: var(--radius-md);
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 12px;
        }

        .summary-icon.spend { background: #fef3c7; color: #d97706; }
        .summary-icon.accounts { background: #dbeafe; color: #2563eb; }
        .summary-icon.demos { background: #d1fae5; color: #059669; }
        .summary-icon.deals { background: #f3e8ff; color: #7c3aed; }
        .summary-icon.dealpoints { background: #fce7f3; color: #db2777; }
        .summary-icon.mrr { background: #ecfdf5; color: #047857; }
        .summary-icon.closedmrr { background: #d1fae5; color: #059669; }
        .summary-icon.cpa { background: #e0f2fe; color: #0284c7; }
        .summary-icon.cpaccount { background: #f0f9ff; color: #0369a1; }
        .summary-icon.cpdeal { background: #fdf4ff; color: #a21caf; }
        .summary-icon.cpdealpt { background: #fefce8; color: #a16207; }
        .summary-icon.directconv { background: #fff7ed; color: #ea580c; }
        .summary-icon.directmrr { background: #fef9c3; color: #ca8a04; }
        .summary-icon.directdp { background: #f0fdf4; color: #16a34a; }

        .summary-label { font-size: 13px; color: var(--text-muted); margin-bottom: 4px; }

        .summary-value {
            font-size: 28px; font-weight: 700;
            font-family: 'Inter', sans-serif;
            letter-spacing: -0.02em;
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px; margin-bottom: 24px;
        }

        .chart-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 24px;
        }

        .chart-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px;
        }

        .chart-title { font-size: 15px; font-weight: 600; }

        .chart-legend { display: flex; gap: 16px; }

        .legend-item { display: flex; align-items: center; gap: 6px; font-size: 12px; color: var(--text-secondary); }

        .legend-dot { width: 8px; height: 8px; border-radius: 50%; }

        .chart-container { height: 280px; position: relative; }

        /* Data Table */
        .table-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .table-header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
        }

        .table-title { font-size: 15px; font-weight: 600; }

        .search-input {
            padding: 8px 12px 8px 36px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: 13px; font-family: inherit; width: 240px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='M21 21l-4.35-4.35'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: 12px center;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--border-focus);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .data-table { width: 100%; border-collapse: collapse; }

        .data-table th {
            text-align: left; font-size: 11px; font-weight: 600;
            color: var(--text-muted); text-transform: uppercase;
            letter-spacing: 0.05em; padding: 12px 16px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            cursor: pointer; user-select: none;
        }

        .data-table th:hover { background: var(--bg-tertiary); }
        .data-table th:not(:first-child) { text-align: right; }

        .data-table td {
            padding: 14px 16px; font-size: 13px;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .data-table td:not(:first-child) {
            text-align: right;
            font-family: 'Inter', sans-serif;
            font-size: 12px;
        }

        .data-table tr:last-child td { border-bottom: none; }
        .data-table tbody tr:hover td { background: var(--bg-hover); }

        .channel-cell { display: flex; align-items: center; gap: 12px; }

        .channel-icon {
            width: 32px; height: 32px;
            border-radius: var(--radius-sm);
            display: flex; align-items: center; justify-content: center;
            font-size: 11px; font-weight: 600; color: white;
        }

        .channel-icon.google { background: #4285f4; }
        .channel-icon.bing { background: #00a4ef; }
        .channel-icon.reddit { background: #ff4500; }
        .channel-icon.linkedin { background: #0077b5; }
        .channel-icon.facebook { background: #1877f2; }
        .channel-icon.youtube { background: #ff0000; }
        .channel-icon.capterra { background: #ff6d00; }
        .channel-icon.affiliate { background: #8b5cf6; }
        .channel-icon.forbes { background: #333; }
        .channel-icon.outbound { background: #059669; }
        .channel-icon.microsoft { background: #0078d4; }
        .channel-icon.revleads { background: #ec4899; }
        .channel-icon.selectsoftware { background: #f59e0b; }
        .channel-icon.email { background: #6366f1; }
        .channel-icon.capterracpl { background: #ff6d00; }
        .channel-icon.outboundmql { background: #10b981; }
        .channel-icon.outboundcold { background: #14b8a6; }
        .channel-icon.affiliate { background: #8b5cf6; }
        .channel-icon.seo { background: #059669; }
        .channel-icon.brandcitations { background: #7c3aed; }
        .channel-icon.directory { background: #0891b2; }
        .channel-icon.redditcommunity { background: #ff4500; }
        .channel-icon.socials { background: #1da1f2; }
        .channel-icon.employee { background: #10b981; }
        .channel-icon.imevents { background: #8b5cf6; }
        .channel-icon.awareness { background: #f59e0b; }
        .channel-icon.brand { background: #ec4899; }
        .channel-icon.conversion { background: #10b981; }
        .channel-icon.untracked { background: #64748b; }

        /* Outbound channel icons */
        .channel-icon.colddata { background: #3b82f6; }
        .channel-icon.sociallistening { background: #8b5cf6; }
        .channel-icon.socialmedia { background: #ec4899; }
        .channel-icon.coldemails { background: #6366f1; }
        .channel-icon.signups { background: #10b981; }
        .channel-icon.subscriber { background: #f59e0b; }
        .channel-icon.breakout { background: #ef4444; }
        .channel-icon.adcampaign { background: #14b8a6; }
        .channel-icon.noshow { background: #f97316; }
        .channel-icon.dropoff { background: #dc2626; }

        .channel-name { font-weight: 500; color: var(--text-primary); }

        /* SDR Section Styles */
        .sdr-section {
            margin-top: 24px;
        }

        .sdr-section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .sdr-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        .sdr-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            transition: all 0.2s;
        }

        .sdr-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .sdr-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .sdr-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            color: white;
            text-transform: uppercase;
        }

        .sdr-info {
            flex: 1;
        }

        .sdr-name {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .sdr-role {
            font-size: 12px;
            color: var(--text-muted);
        }

        .sdr-metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .sdr-metric {
            text-align: center;
            padding: 10px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
        }

        .sdr-metric-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .sdr-metric-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 2px;
        }

        .sdr-table {
            width: 100%;
            border-collapse: collapse;
        }

        .sdr-table th,
        .sdr-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .sdr-table th {
            background: var(--bg-tertiary);
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .sdr-table td {
            font-size: 14px;
        }

        .sdr-table tr:hover td {
            background: var(--bg-hover);
        }

        .sdr-name-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sdr-mini-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 12px;
            color: white;
            text-transform: uppercase;
        }

        /* Weekly Cards */
        .weekly-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px; margin-top: 24px;
        }

        .week-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            cursor: pointer; transition: all 0.2s;
        }

        .week-card:hover { box-shadow: var(--shadow-md); }
        .week-card.active { border-color: var(--accent-primary); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }

        .week-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }

        .week-label { font-size: 14px; font-weight: 600; }
        .week-dates { font-size: 11px; color: var(--text-muted); }

        .week-metrics { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }

        .week-metric { padding: 8px 10px; background: var(--bg-secondary); border-radius: var(--radius-sm); }

        .week-metric-label {
            font-size: 9px; color: var(--text-muted);
            text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 2px;
        }

        .week-metric-value {
            font-size: 13px; font-weight: 600;
            font-family: 'Inter', sans-serif;
        }

        .week-metric-row {
            display: flex; align-items: center; justify-content: space-between; gap: 4px;
        }

        .growth-indicator {
            display: inline-flex; align-items: center; gap: 2px;
            font-size: 10px; font-weight: 500; padding: 2px 4px;
            border-radius: 4px;
        }

        .growth-indicator.up { background: #d1fae5; color: #059669; }
        .growth-indicator.down { background: #fee2e2; color: #dc2626; }
        .growth-indicator.neutral { background: #f1f5f9; color: #64748b; }

        .growth-indicator svg { width: 10px; height: 10px; }

        /* Chart Controls */
        .chart-controls {
            display: flex; align-items: center; gap: 12px;
        }

        .chart-metric-select {
            padding: 6px 28px 6px 10px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 12px; font-family: inherit;
            color: var(--text-primary); background: var(--bg-primary);
            cursor: pointer; appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
        }

        /* Loading */
        .loading-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: var(--bg-primary);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 1000;
        }

        .loading-spinner {
            width: 40px; height: 40px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }

        .loading-text { color: var(--text-secondary); font-size: 14px; }

        /* Toast */
        .toast {
            position: fixed; bottom: 24px; right: 24px;
            background: var(--text-primary); color: white;
            padding: 12px 20px; border-radius: var(--radius-md);
            font-size: 13px; display: flex; align-items: center; gap: 10px;
            box-shadow: var(--shadow-lg); z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .toast.error { background: var(--accent-danger); }

        @keyframes slideIn { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* Responsive */
        @media (max-width: 1600px) {
            .summary-grid { grid-template-columns: repeat(4, 1fr); }
        }

        @media (max-width: 1400px) {
            .summary-grid { grid-template-columns: repeat(3, 1fr); }
            .charts-grid { grid-template-columns: 1fr; }
        }

        @media (max-width: 1024px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; }
            .weekly-grid { grid-template-columns: repeat(2, 1fr); }
            .summary-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            .summary-grid { grid-template-columns: repeat(2, 1fr); }
            .topbar { flex-direction: column; gap: 12px; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // ============================================
        // CONFIGURATION - UPDATE YOUR API KEY HERE
        // ============================================
        const API_KEY = 'AIzaSyC-MIaq9T9lhvKtvjEritwv1uSq9NhME-0';
        
        // Spreadsheet IDs for each pod
        const POD_SPREADSHEETS = {
            conversion: '1Rq85bACiKxewmW9vpsZ7vTZYTnkMBYsGxOzhxj_m_WE',
            brand: '1qBPiHwq7yAH-le1W2rUMMma97TtDVeV9r_GHsyrEXSs',
            awareness: '1u0gIrFqEiPtsmaKF9BedN3r8eV_3JWe-2h364tdIeRk',
            all: '1W8ycV7bmJJt_jtCVOXU_VUH-pK4OIeOaFXhWZFSdFWs',
            leadership: '1W8ycV7bmJJt_jtCVOXU_VUH-pK4OIeOaFXhWZFSdFWs', // Uses same overview sheet
            outbound: '1bRp9hnQdOnppaoK6WsPdzYj2XeedO1G5TQ4iqJcIWlQ' // Independent outbound sheet
        };
        // ============================================

        const MONTHS = [
            { key: 'January', label: 'January', short: 'Jan' },
            { key: 'February', label: 'February', short: 'Feb' },
            { key: 'March', label: 'March', short: 'Mar' },
            { key: 'April', label: 'April', short: 'Apr' },
            { key: 'May', label: 'May', short: 'May' },
            { key: 'June', label: 'June', short: 'Jun' },
            { key: 'July', label: 'July', short: 'Jul' },
            { key: 'August', label: 'August', short: 'Aug' },
            { key: 'September', label: 'September', short: 'Sep' },
            { key: 'October', label: 'October', short: 'Oct' },
            { key: 'November', label: 'November', short: 'Nov' },
            { key: 'December', label: 'December', short: 'Dec' }
        ];

        // Channel definitions matching your sheet structure
        const CHANNEL_GROUPS = [
            // Row 18-36: First group of channels
            { name: 'Google Search Ads', icon: 'google', short: 'G', row: 18, col: 3 },
            { name: 'Bing Search Ads', icon: 'bing', short: 'B', row: 18, col: 6 },
            { name: 'Reddit Ads', icon: 'reddit', short: 'R', row: 18, col: 9 },
            { name: 'LinkedIn Ads', icon: 'linkedin', short: 'in', row: 18, col: 12 },
            { name: 'Facebook Ads', icon: 'facebook', short: 'f', row: 18, col: 15 },
            // Row 38+: Second group
            { name: 'Microsoft Display Ads', icon: 'microsoft', short: 'M', row: 38, col: 3 },
            { name: 'YouTube Ads', icon: 'youtube', short: '▶', row: 38, col: 6 },
            { name: 'Capterra CPC', icon: 'capterra', short: 'C', row: 38, col: 9 },
            { name: 'RevLeads CPC', icon: 'revleads', short: 'R', row: 38, col: 12 },
            { name: 'Select Software Reviews', icon: 'selectsoftware', short: 'S', row: 38, col: 15 }
        ];

        const WEEKS = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
        const WEEK_DATES = { 'Week 1': '1st - 7th', 'Week 2': '8th - 14th', 'Week 3': '15th - 21st', 'Week 4': '22nd - End' };

        // Utilities
        const formatCurrency = (value) => {
            const num = parseFloat(String(value).replace(/[$,]/g, '')) || 0;
            if (num >= 1000000) return '$' + (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return '$' + (num / 1000).toFixed(1) + 'K';
            return '$' + num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
        };

        const formatNumber = (value) => {
            const num = parseFloat(String(value).replace(/[$,]/g, '')) || 0;
            return num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 1 });
        };

        const calcGrowth = (current, previous) => {
            if (!previous || previous === 0) return { percent: 0, direction: 'neutral' };
            const percent = ((current - previous) / previous) * 100;
            return {
                percent: Math.abs(percent).toFixed(1),
                direction: percent > 0 ? 'up' : percent < 0 ? 'down' : 'neutral'
            };
        };

        const CHART_METRICS = [
            { key: 'spend', label: 'Spend', format: 'currency' },
            { key: 'accounts', label: 'Accounts', format: 'number' },
            { key: 'demos', label: 'Demos', format: 'number' },
            { key: 'deals', label: 'Deals', format: 'number' },
            { key: 'dealPoints', label: 'Deal Points', format: 'number' },
            { key: 'generatedMRR', label: 'Generated MRR', format: 'currency' },
            { key: 'closedMRR', label: 'Closed MRR', format: 'currency' },
            { key: 'directConversions', label: 'Direct Conversions', format: 'number' },
            { key: 'directConversionsMRR', label: 'Direct Conv. MRR', format: 'currency' }
        ];

        const parseValue = (value) => {
            if (!value || value === '' || value === '#DIV/0!' || value === '-') return 0;
            return parseFloat(String(value).replace(/[$,]/g, '')) || 0;
        };

        // Icons
        const Icons = {
            refresh: <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>,
            download: <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>,
            dollar: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></svg>,
            users: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>,
            calendar: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/></svg>,
            target: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
            trending: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/></svg>,
            percent: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="19" y1="5" x2="5" y2="19"/><circle cx="6.5" cy="6.5" r="2.5"/><circle cx="17.5" cy="17.5" r="2.5"/></svg>,
            check: <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            star: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            award: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>,
            arrowUp: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></svg>,
            trendUp: <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
            trendDown: <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/><polyline points="17 18 23 18 23 12"/></svg>,
            minus: <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><line x1="5" y1="12" x2="19" y2="12"/></svg>,
            mouse: <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="6" y="3" width="12" height="18" rx="6"/><line x1="12" y1="7" x2="12" y2="11"/></svg>,
            grid: <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>,
            eye: <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>,
            heart: <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>,
            zap: <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
            help: <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
            crown: <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg>,
            send: <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
            globe: <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/></svg>
        };

        const PODS = [
            { key: 'leadership', label: 'Leadership', icon: 'crown', iconClass: 'leadership' },
            { key: 'all', label: 'All Pods', icon: 'grid', iconClass: 'all' },
            { key: 'awareness', label: 'Awareness Pod', icon: 'eye', iconClass: 'awareness' },
            { key: 'brand', label: 'Brand Advocacy Pod', icon: 'heart', iconClass: 'brand' },
            { key: 'conversion', label: 'Conversion Pod', icon: 'zap', iconClass: 'conversion' },
            { key: 'untracked', label: 'Misc Pod', icon: 'help', iconClass: 'untracked' },
            { key: 'outbound', label: 'Outbound', icon: 'send', iconClass: 'outbound' }
        ];

        function Dashboard() {
            const [selectedPod, setSelectedPod] = useState('conversion');
            const [selectedMonth, setSelectedMonth] = useState('January');
            const [selectedWeek, setSelectedWeek] = useState('MTD');
            const [chartMetric, setChartMetric] = useState('spend');
            const [searchTerm, setSearchTerm] = useState('');
            const [sortConfig, setSortConfig] = useState({ key: 'spend', direction: 'desc' });
            const [data, setData] = useState({});
            const [availableMonths, setAvailableMonths] = useState(['January']);
            const [loading, setLoading] = useState(true);
            const [refreshing, setRefreshing] = useState(false);
            const [error, setError] = useState(null);
            const [lastUpdated, setLastUpdated] = useState(null);
            const [nextRefresh, setNextRefresh] = useState(null);
            const [toast, setToast] = useState(null);
            const [countdown, setCountdown] = useState('');

            const trendChartRef = useRef(null);
            const channelChartRef = useRef(null);
            const trendChartInstance = useRef(null);
            const channelChartInstance = useRef(null);

            const showToast = (message, isError = false) => {
                setToast({ message, isError });
                setTimeout(() => setToast(null), 4000);
            };

            // Process sheet data based on YOUR actual structure
            const processSheetData = (rows, month) => {
                if (!rows || rows.length === 0) return getEmptyData(month);

                // Summary data from rows 1-14 (0-indexed: 0-13)
                // Column B (index 1) has the totals
                const summary = {
                    spend: parseValue(rows[1]?.[1]),
                    accounts: parseValue(rows[2]?.[1]),
                    demos: parseValue(rows[3]?.[1]),
                    deals: parseValue(rows[4]?.[1]),
                    dealPoints: parseValue(rows[5]?.[1]),
                    generatedMRR: parseValue(rows[10]?.[1]),
                    closedMRR: parseValue(rows[11]?.[1]),
                    directConversions: parseValue(rows[12]?.[1]),
                    directConversionsMRR: parseValue(rows[13]?.[1]),
                    directConversionsDealPoints: parseValue(rows[14]?.[1])
                };

                // Weekly data from columns D, G, J, M (indices 3, 6, 9, 12)
                const weeks = WEEKS.map((week, idx) => {
                    const colOffset = idx * 3 + 3; // Week 1=3, Week 2=6, Week 3=9, Week 4=12
                    return {
                    label: week,
                    dates: WEEK_DATES[week],
                        spend: parseValue(rows[1]?.[colOffset]),
                        accounts: parseValue(rows[2]?.[colOffset]),
                        demos: parseValue(rows[3]?.[colOffset]),
                        deals: parseValue(rows[4]?.[colOffset]),
                        dealPoints: parseValue(rows[5]?.[colOffset]),
                        generatedMRR: parseValue(rows[10]?.[colOffset]),
                        closedMRR: parseValue(rows[11]?.[colOffset]),
                        directConversions: parseValue(rows[12]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[13]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[14]?.[colOffset])
                    };
                });

                // Channel data
                // First group starts at row 18 (index 17), values in column D (index 3)
                // Each channel is 3 columns apart
                const channels = [];
                
                // First group: rows 18-31 (Google, Bing, Reddit, LinkedIn, Facebook)
                const group1Channels = ['Google Search Ads', 'Bing Search Ads', 'Reddit Ads', 'LinkedIn Ads', 'Facebook Ads'];
                const group1Icons = ['google', 'bing', 'reddit', 'linkedin', 'facebook'];
                const group1Shorts = ['G', 'B', 'R', 'in', 'f'];
                
                group1Channels.forEach((name, idx) => {
                    const colOffset = idx * 3 + 3; // D, G, J, M, P (3, 6, 9, 12, 15)
                    channels.push({
                        name,
                        icon: group1Icons[idx],
                        short: group1Shorts[idx],
                        spend: parseValue(rows[18]?.[colOffset]),
                        accounts: parseValue(rows[19]?.[colOffset]),
                        demos: parseValue(rows[20]?.[colOffset]),
                        deals: parseValue(rows[21]?.[colOffset]),
                        dealPoints: parseValue(rows[22]?.[colOffset]),
                        generatedMRR: parseValue(rows[27]?.[colOffset]),
                        closedMRR: parseValue(rows[28]?.[colOffset]),
                        directConversions: parseValue(rows[29]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[30]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[31]?.[colOffset]),
                        cpc: parseValue(rows[32]?.[colOffset]),
                        clicks: parseValue(rows[33]?.[colOffset]),
                        impressions: parseValue(rows[34]?.[colOffset]),
                        ctr: parseValue(rows[35]?.[colOffset])
                    });
                });

                // Second group: rows 38+ (Microsoft, YouTube, Capterra CPC, RevLeads, Select Software)
                const group2Channels = ['Microsoft Display Ads', 'YouTube Ads', 'Capterra CPC', 'RevLeads CPC', 'Select Software Reviews'];
                const group2Icons = ['microsoft', 'youtube', 'capterra', 'revleads', 'selectsoftware'];
                const group2Shorts = ['M', '▶', 'C', 'R', 'S'];
                
                group2Channels.forEach((name, idx) => {
                    const colOffset = idx * 3 + 3;
                    channels.push({
                        name,
                        icon: group2Icons[idx],
                        short: group2Shorts[idx],
                        spend: parseValue(rows[38]?.[colOffset]),
                        accounts: parseValue(rows[39]?.[colOffset]),
                        demos: parseValue(rows[40]?.[colOffset]),
                        deals: parseValue(rows[41]?.[colOffset]),
                        dealPoints: parseValue(rows[42]?.[colOffset]),
                        generatedMRR: parseValue(rows[47]?.[colOffset]),
                        closedMRR: parseValue(rows[48]?.[colOffset]),
                        directConversions: parseValue(rows[49]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[50]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[51]?.[colOffset]),
                        cpc: parseValue(rows[52]?.[colOffset]),
                        clicks: parseValue(rows[53]?.[colOffset]),
                        impressions: parseValue(rows[54]?.[colOffset]),
                        ctr: parseValue(rows[55]?.[colOffset])
                    });
                });

                // Third group: rows 58+ (Forbes CPL, Capterra CPL, Outbound MQL, Outbound Cold, Affiliate, Email)
                const group3Channels = ['Forbes CPL', 'Capterra CPL', 'Outbound - MQL Data', 'Outbound - Cold Data', 'Affiliate', 'Email'];
                const group3Icons = ['forbes', 'capterracpl', 'outboundmql', 'outboundcold', 'affiliate', 'email'];
                const group3Shorts = ['F', 'C', 'M', 'O', 'A', 'E'];
                
                group3Channels.forEach((name, idx) => {
                    const colOffset = idx * 3 + 3;
                    channels.push({
                        name,
                        icon: group3Icons[idx],
                        short: group3Shorts[idx],
                        spend: parseValue(rows[58]?.[colOffset]),
                        accounts: parseValue(rows[59]?.[colOffset]),
                        demos: parseValue(rows[60]?.[colOffset]),
                        deals: parseValue(rows[61]?.[colOffset]),
                        dealPoints: parseValue(rows[62]?.[colOffset]),
                        generatedMRR: parseValue(rows[67]?.[colOffset]),
                        closedMRR: parseValue(rows[68]?.[colOffset]),
                        directConversions: parseValue(rows[69]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[70]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[71]?.[colOffset]),
                        cpc: parseValue(rows[72]?.[colOffset]),
                        clicks: parseValue(rows[73]?.[colOffset]),
                        impressions: parseValue(rows[74]?.[colOffset]),
                        ctr: parseValue(rows[75]?.[colOffset])
                    });
                });

                // Calculate totals from channels if summary is 0
                if (summary.spend === 0) {
                    summary.spend = channels.reduce((sum, ch) => sum + ch.spend, 0);
                }

                return { summary, weeks, channels, month };
            };

            // Process Brand Advocacy sheet data (different structure)
            const processBrandAdvocacyData = (rows, month) => {
                if (!rows || rows.length === 0) return getEmptyData(month);

                // Brand Advocacy structure: MTD totals in column O (index 14)
                const summaryCol = 14;
                const summary = {
                    spend: parseValue(rows[1]?.[summaryCol]),
                    accounts: parseValue(rows[2]?.[summaryCol]),
                    demos: parseValue(rows[3]?.[summaryCol]),
                    deals: parseValue(rows[4]?.[summaryCol]),
                    dealPoints: parseValue(rows[5]?.[summaryCol]),
                    generatedMRR: parseValue(rows[10]?.[summaryCol]),
                    closedMRR: parseValue(rows[11]?.[summaryCol]),
                    directConversions: parseValue(rows[12]?.[summaryCol]),
                    directConversionsMRR: parseValue(rows[13]?.[summaryCol]),
                    directConversionsDealPoints: parseValue(rows[14]?.[summaryCol])
                };

                // Weekly data at indices 2, 5, 8, 11
                const weeks = WEEKS.map((week, idx) => {
                    const colOffset = idx * 3 + 2; // Week 1=2, Week 2=5, Week 3=8, Week 4=11
                    return {
                        label: week,
                        dates: WEEK_DATES[week],
                        spend: parseValue(rows[1]?.[colOffset]),
                        accounts: parseValue(rows[2]?.[colOffset]),
                        demos: parseValue(rows[3]?.[colOffset]),
                        deals: parseValue(rows[4]?.[colOffset]),
                        dealPoints: parseValue(rows[5]?.[colOffset]),
                        generatedMRR: parseValue(rows[10]?.[colOffset]),
                        closedMRR: parseValue(rows[11]?.[colOffset]),
                        directConversions: parseValue(rows[12]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[13]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[14]?.[colOffset])
                    };
                });

                // Brand Advocacy channels: SEO, Brand Citations, Directory Listings (row 17+)
                const channels = [];
                const brandChannels = ['SEO', 'Brand Citations', 'Directory Listings'];
                const brandIcons = ['seo', 'brandcitations', 'directory'];
                const brandShorts = ['S', 'BC', 'D'];
                
                brandChannels.forEach((name, idx) => {
                    const colOffset = idx * 3 + 2;
                    channels.push({
                        name,
                        icon: brandIcons[idx],
                        short: brandShorts[idx],
                        spend: parseValue(rows[18]?.[colOffset]),
                        accounts: parseValue(rows[19]?.[colOffset]),
                        demos: parseValue(rows[20]?.[colOffset]),
                        deals: parseValue(rows[21]?.[colOffset]),
                        dealPoints: parseValue(rows[22]?.[colOffset]),
                        generatedMRR: parseValue(rows[27]?.[colOffset]),
                        closedMRR: parseValue(rows[28]?.[colOffset]),
                        directConversions: parseValue(rows[29]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[30]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[31]?.[colOffset]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    });
                });

                return { summary, weeks, channels, month };
            };

            // Process Awareness Pod sheet data (same structure as Brand Advocacy)
            const processAwarenessData = (rows, month) => {
                if (!rows || rows.length === 0) return getEmptyData(month);

                // Same structure as Brand Advocacy: MTD totals in column O (index 14)
                const summaryCol = 14;
                const summary = {
                    spend: parseValue(rows[1]?.[summaryCol]),
                    accounts: parseValue(rows[2]?.[summaryCol]),
                    demos: parseValue(rows[3]?.[summaryCol]),
                    deals: parseValue(rows[4]?.[summaryCol]),
                    dealPoints: parseValue(rows[5]?.[summaryCol]),
                    generatedMRR: parseValue(rows[10]?.[summaryCol]),
                    closedMRR: parseValue(rows[11]?.[summaryCol]),
                    directConversions: parseValue(rows[12]?.[summaryCol]),
                    directConversionsMRR: parseValue(rows[13]?.[summaryCol]),
                    directConversionsDealPoints: parseValue(rows[14]?.[summaryCol])
                };

                // Weekly data at indices 2, 5, 8, 11
                const weeks = WEEKS.map((week, idx) => {
                    const colOffset = idx * 3 + 2;
                    return {
                        label: week,
                        dates: WEEK_DATES[week],
                        spend: parseValue(rows[1]?.[colOffset]),
                        accounts: parseValue(rows[2]?.[colOffset]),
                        demos: parseValue(rows[3]?.[colOffset]),
                        deals: parseValue(rows[4]?.[colOffset]),
                        dealPoints: parseValue(rows[5]?.[colOffset]),
                        generatedMRR: parseValue(rows[10]?.[colOffset]),
                        closedMRR: parseValue(rows[11]?.[colOffset]),
                        directConversions: parseValue(rows[12]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[13]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[14]?.[colOffset])
                    };
                });

                // Awareness channels: YouTube, Reddit & Communities, Socials, Employee Advocacy, IM & events
                const channels = [];
                const awarenessChannels = ['YouTube', 'Reddit & Communities', 'Socials', 'Employee Advocacy', 'IM & Events'];
                const awarenessIcons = ['youtube', 'redditcommunity', 'socials', 'employee', 'imevents'];
                const awarenessShorts = ['YT', 'RC', 'S', 'EA', 'IM'];
                
                awarenessChannels.forEach((name, idx) => {
                    const colOffset = idx * 3 + 2;
                    channels.push({
                        name,
                        icon: awarenessIcons[idx],
                        short: awarenessShorts[idx],
                        spend: parseValue(rows[18]?.[colOffset]),
                        accounts: parseValue(rows[19]?.[colOffset]),
                        demos: parseValue(rows[20]?.[colOffset]),
                        deals: parseValue(rows[21]?.[colOffset]),
                        dealPoints: parseValue(rows[22]?.[colOffset]),
                        generatedMRR: parseValue(rows[27]?.[colOffset]),
                        closedMRR: parseValue(rows[28]?.[colOffset]),
                        directConversions: parseValue(rows[29]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[30]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[31]?.[colOffset]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    });
                });

                return { summary, weeks, channels, month };
            };

            // Process Outbound Pod sheet data (independent structure)
            // Based on: https://docs.google.com/spreadsheets/d/1bRp9hnQdOnppaoK6WsPdzYj2XeedO1G5TQ4iqJcIWlQ
            const processOutboundData = (rows, month) => {
                if (!rows || rows.length === 0) return getEmptyData(month);

                // Outbound data structure - different from other pods
                // Data types: Cold Data, MQL - Capterra, MQL - Social Listening, etc.
                // This is an independent section - no data flows to other pods
                
                // Summary totals
                const summaryCol = 14; // MTD column
                const summary = {
                    spend: parseValue(rows[1]?.[summaryCol]),
                    accounts: parseValue(rows[2]?.[summaryCol]),
                    demos: parseValue(rows[3]?.[summaryCol]),
                    deals: parseValue(rows[4]?.[summaryCol]),
                    dealPoints: parseValue(rows[5]?.[summaryCol]),
                    generatedMRR: parseValue(rows[10]?.[summaryCol]),
                    closedMRR: parseValue(rows[11]?.[summaryCol]),
                    directConversions: parseValue(rows[12]?.[summaryCol]),
                    directConversionsMRR: parseValue(rows[13]?.[summaryCol]),
                    directConversionsDealPoints: parseValue(rows[14]?.[summaryCol])
                };

                // Weekly data
                const weeks = WEEKS.map((week, idx) => {
                    const colOffset = idx * 3 + 2;
                    return {
                        label: week,
                        dates: WEEK_DATES[week],
                        spend: parseValue(rows[1]?.[colOffset]),
                        accounts: parseValue(rows[2]?.[colOffset]),
                        demos: parseValue(rows[3]?.[colOffset]),
                        deals: parseValue(rows[4]?.[colOffset]),
                        dealPoints: parseValue(rows[5]?.[colOffset]),
                        generatedMRR: parseValue(rows[10]?.[colOffset]),
                        closedMRR: parseValue(rows[11]?.[colOffset]),
                        directConversions: parseValue(rows[12]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[13]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[14]?.[colOffset])
                    };
                });

                // Outbound data source channels
                const channels = [];
                const outboundChannels = [
                    'Cold Data',
                    'MQL - Capterra',
                    'MQL - Social Listening',
                    'MQL - Social Media Engaged',
                    'MQL - Cold Emails',
                    'MQL - Sign Ups',
                    'MQL - Subscriber Data',
                    'MQL - Breakout Leads',
                    'MQL - Ad Campaign Data',
                    'MQL - Demo No Show',
                    'MQL - Demo Dropoff'
                ];
                const outboundIcons = ['colddata', 'capterra', 'sociallistening', 'socialmedia', 'coldemails', 'signups', 'subscriber', 'breakout', 'adcampaign', 'noshow', 'dropoff'];
                const outboundShorts = ['CD', 'CT', 'SL', 'SM', 'CE', 'SU', 'SD', 'BL', 'AC', 'NS', 'DO'];
                
                outboundChannels.forEach((name, idx) => {
                    const colOffset = idx * 3 + 2;
                    channels.push({
                        name,
                        icon: outboundIcons[idx],
                        short: outboundShorts[idx],
                        spend: parseValue(rows[18]?.[colOffset]),
                        accounts: parseValue(rows[19]?.[colOffset]),
                        demos: parseValue(rows[20]?.[colOffset]),
                        deals: parseValue(rows[21]?.[colOffset]),
                        dealPoints: parseValue(rows[22]?.[colOffset]),
                        generatedMRR: parseValue(rows[27]?.[colOffset]),
                        closedMRR: parseValue(rows[28]?.[colOffset]),
                        directConversions: parseValue(rows[29]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[30]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[31]?.[colOffset]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    });
                });

                // Parse SDR data from the sheet
                // SDR names are typically in column A, starting from a specific row
                // We'll look for rows that contain SDR data
                const sdrs = [];
                
                // Look for SDR data starting from row 40+ (after channel data)
                // Each SDR has their name in column A and metrics in subsequent columns
                for (let i = 40; i < Math.min(rows.length, 80); i++) {
                    const name = rows[i]?.[0];
                    // Skip empty rows or header rows
                    if (name && name.trim() !== '' && !name.includes('SDR') && !name.includes('Total') && !name.includes('DATA')) {
                        const sdr = {
                            name: name.trim(),
                            demos: parseValue(rows[i]?.[1]),
                            deals: parseValue(rows[i]?.[2]),
                            dealPoints: parseValue(rows[i]?.[3]),
                            accounts: parseValue(rows[i]?.[4]),
                            generatedMRR: parseValue(rows[i]?.[5]),
                            closedMRR: parseValue(rows[i]?.[6]),
                            directConversions: parseValue(rows[i]?.[7]),
                            target: parseValue(rows[i]?.[8]),
                            incentive: rows[i]?.[9] || ''
                        };
                        // Only add if SDR has some data
                        if (sdr.demos > 0 || sdr.deals > 0 || sdr.accounts > 0 || sdr.name.length > 2) {
                            sdrs.push(sdr);
                        }
                    }
                }

                // Also check for SDR names in a different location (column-based layout)
                // Some sheets have SDRs across columns starting from column C
                if (sdrs.length === 0) {
                    // Try reading SDR names from row 1 or 2 across columns
                    const headerRow = rows[0] || [];
                    const dataRow = rows[1] || [];
                    
                    for (let col = 2; col < Math.min(headerRow.length, 20); col++) {
                        const name = headerRow[col];
                        if (name && name.trim() !== '' && !name.includes('Week') && !name.includes('MTD') && !name.includes('Total')) {
                            sdrs.push({
                                name: name.trim(),
                                demos: parseValue(rows[3]?.[col]),
                                deals: parseValue(rows[4]?.[col]),
                                dealPoints: parseValue(rows[5]?.[col]),
                                accounts: parseValue(rows[2]?.[col]),
                                generatedMRR: parseValue(rows[10]?.[col]),
                                closedMRR: parseValue(rows[11]?.[col]),
                                directConversions: parseValue(rows[12]?.[col]),
                                target: 0,
                                incentive: ''
                            });
                        }
                    }
                }

                return { summary, weeks, channels, sdrs, month };
            };

            // Process All Pods Overview sheet (different structure - Overview tab)
            const processAllPodsData = (rows, month) => {
                if (!rows || rows.length === 0) return getEmptyData(month);

                // All-time totals are in column B (index 1) at rows 1-14
                const summary = {
                    spend: parseValue(rows[1]?.[1]),
                    accounts: parseValue(rows[2]?.[1]),
                    demos: parseValue(rows[3]?.[1]),
                    deals: parseValue(rows[4]?.[1]),
                    dealPoints: parseValue(rows[5]?.[1]),
                    generatedMRR: parseValue(rows[10]?.[1]),
                    closedMRR: parseValue(rows[11]?.[1]),
                    directConversions: parseValue(rows[12]?.[1]),
                    directConversionsMRR: parseValue(rows[13]?.[1]),
                    directConversionsDealPoints: parseValue(rows[14]?.[1])
                };

                // Monthly data starts at row 18, with months in columns C-N (indices 2-13)
                // Use months as "weeks" for display purposes
                const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                const weeks = monthNames.slice(0, 4).map((m, idx) => {
                    const colOffset = idx + 2; // Jan=2, Feb=3, Mar=4, Apr=5
                    return {
                        label: m,
                        dates: `${m} 2026`,
                        spend: parseValue(rows[19]?.[colOffset]),
                        accounts: parseValue(rows[20]?.[colOffset]),
                        demos: parseValue(rows[21]?.[colOffset]),
                        deals: parseValue(rows[22]?.[colOffset]),
                        dealPoints: parseValue(rows[23]?.[colOffset]),
                        generatedMRR: parseValue(rows[28]?.[colOffset]),
                        closedMRR: parseValue(rows[29]?.[colOffset]),
                        directConversions: parseValue(rows[30]?.[colOffset]),
                        directConversionsMRR: parseValue(rows[31]?.[colOffset]),
                        directConversionsDealPoints: parseValue(rows[32]?.[colOffset])
                    };
                });

                // Pod breakdown as channels (from rows 0-14, different columns for each pod)
                const channels = [
                    {
                        name: 'Awareness Pod',
                        icon: 'awareness',
                        short: 'AW',
                        spend: parseValue(rows[1]?.[4]),
                        accounts: parseValue(rows[2]?.[4]),
                        demos: parseValue(rows[3]?.[4]),
                        deals: parseValue(rows[4]?.[4]),
                        dealPoints: parseValue(rows[5]?.[4]),
                        generatedMRR: parseValue(rows[10]?.[4]),
                        closedMRR: parseValue(rows[11]?.[4]),
                        directConversions: parseValue(rows[12]?.[4]),
                        directConversionsMRR: parseValue(rows[13]?.[4]),
                        directConversionsDealPoints: parseValue(rows[14]?.[4]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    },
                    {
                        name: 'Brand Advocacy Pod',
                        icon: 'brand',
                        short: 'BA',
                        spend: parseValue(rows[1]?.[6]),
                        accounts: parseValue(rows[2]?.[6]),
                        demos: parseValue(rows[3]?.[6]),
                        deals: parseValue(rows[4]?.[6]),
                        dealPoints: parseValue(rows[5]?.[6]),
                        generatedMRR: parseValue(rows[10]?.[6]),
                        closedMRR: parseValue(rows[11]?.[6]),
                        directConversions: parseValue(rows[12]?.[6]),
                        directConversionsMRR: parseValue(rows[13]?.[6]),
                        directConversionsDealPoints: parseValue(rows[14]?.[6]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    },
                    {
                        name: 'Conversion Pod',
                        icon: 'conversion',
                        short: 'CV',
                        spend: parseValue(rows[1]?.[8]),
                        accounts: parseValue(rows[2]?.[8]),
                        demos: parseValue(rows[3]?.[8]),
                        deals: parseValue(rows[4]?.[8]),
                        dealPoints: parseValue(rows[5]?.[8]),
                        generatedMRR: parseValue(rows[10]?.[8]),
                        closedMRR: parseValue(rows[11]?.[8]),
                        directConversions: parseValue(rows[12]?.[8]),
                        directConversionsMRR: parseValue(rows[13]?.[8]),
                        directConversionsDealPoints: parseValue(rows[14]?.[8]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    },
                    {
                        name: 'Misc Pod',
                        icon: 'untracked',
                        short: 'UT',
                        spend: parseValue(rows[1]?.[10]),
                        accounts: parseValue(rows[2]?.[10]),
                        demos: parseValue(rows[3]?.[10]),
                        deals: parseValue(rows[4]?.[10]),
                        dealPoints: parseValue(rows[5]?.[10]),
                        generatedMRR: parseValue(rows[10]?.[10]),
                        closedMRR: parseValue(rows[11]?.[10]),
                        directConversions: parseValue(rows[12]?.[10]),
                        directConversionsMRR: parseValue(rows[13]?.[10]),
                        directConversionsDealPoints: parseValue(rows[14]?.[10]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    }
                ];

                return { summary, weeks, channels, month: 'All Time' };
            };

            // Process Leadership data - All-time aggregated from All Pods sheet plus all channels from each pod
            const processLeadershipData = (allPodsRows, conversionRows, brandRows, awarenessRows) => {
                // Use All Pods summary for all-time totals (column B, index 1)
                const summary = {
                    spend: parseValue(allPodsRows[1]?.[1]),
                    accounts: parseValue(allPodsRows[2]?.[1]),
                    demos: parseValue(allPodsRows[3]?.[1]),
                    deals: parseValue(allPodsRows[4]?.[1]),
                    dealPoints: parseValue(allPodsRows[5]?.[1]),
                    generatedMRR: parseValue(allPodsRows[10]?.[1]),
                    closedMRR: parseValue(allPodsRows[11]?.[1]),
                    directConversions: parseValue(allPodsRows[12]?.[1]),
                    directConversionsMRR: parseValue(allPodsRows[13]?.[1]),
                    directConversionsDealPoints: parseValue(allPodsRows[14]?.[1])
                };

                // Monthly trend data for the chart
                const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                const weeks = monthNames.slice(0, 6).map((m, idx) => {
                    const colOffset = idx + 2;
                    return {
                        label: m,
                        dates: `${m} 2026`,
                        spend: parseValue(allPodsRows[19]?.[colOffset]),
                        accounts: parseValue(allPodsRows[20]?.[colOffset]),
                        demos: parseValue(allPodsRows[21]?.[colOffset]),
                        deals: parseValue(allPodsRows[22]?.[colOffset]),
                        dealPoints: parseValue(allPodsRows[23]?.[colOffset]),
                        generatedMRR: parseValue(allPodsRows[28]?.[colOffset]),
                        closedMRR: parseValue(allPodsRows[29]?.[colOffset]),
                        directConversions: parseValue(allPodsRows[30]?.[colOffset]),
                        directConversionsMRR: parseValue(allPodsRows[31]?.[colOffset]),
                        directConversionsDealPoints: parseValue(allPodsRows[32]?.[colOffset])
                    };
                });

                // Pod summary breakdown from All Pods sheet
                const podChannels = [
                    {
                        name: 'Awareness Pod (Total)',
                        icon: 'awareness',
                        short: 'AW',
                        pod: 'Awareness',
                        spend: parseValue(allPodsRows[1]?.[4]),
                        accounts: parseValue(allPodsRows[2]?.[4]),
                        demos: parseValue(allPodsRows[3]?.[4]),
                        deals: parseValue(allPodsRows[4]?.[4]),
                        dealPoints: parseValue(allPodsRows[5]?.[4]),
                        generatedMRR: parseValue(allPodsRows[10]?.[4]),
                        closedMRR: parseValue(allPodsRows[11]?.[4]),
                        directConversions: parseValue(allPodsRows[12]?.[4]),
                        directConversionsMRR: parseValue(allPodsRows[13]?.[4]),
                        directConversionsDealPoints: parseValue(allPodsRows[14]?.[4]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    },
                    {
                        name: 'Brand Advocacy Pod (Total)',
                        icon: 'brand',
                        short: 'BA',
                        pod: 'Brand',
                        spend: parseValue(allPodsRows[1]?.[6]),
                        accounts: parseValue(allPodsRows[2]?.[6]),
                        demos: parseValue(allPodsRows[3]?.[6]),
                        deals: parseValue(allPodsRows[4]?.[6]),
                        dealPoints: parseValue(allPodsRows[5]?.[6]),
                        generatedMRR: parseValue(allPodsRows[10]?.[6]),
                        closedMRR: parseValue(allPodsRows[11]?.[6]),
                        directConversions: parseValue(allPodsRows[12]?.[6]),
                        directConversionsMRR: parseValue(allPodsRows[13]?.[6]),
                        directConversionsDealPoints: parseValue(allPodsRows[14]?.[6]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    },
                    {
                        name: 'Conversion Pod (Total)',
                        icon: 'conversion',
                        short: 'CV',
                        pod: 'Conversion',
                        spend: parseValue(allPodsRows[1]?.[8]),
                        accounts: parseValue(allPodsRows[2]?.[8]),
                        demos: parseValue(allPodsRows[3]?.[8]),
                        deals: parseValue(allPodsRows[4]?.[8]),
                        dealPoints: parseValue(allPodsRows[5]?.[8]),
                        generatedMRR: parseValue(allPodsRows[10]?.[8]),
                        closedMRR: parseValue(allPodsRows[11]?.[8]),
                        directConversions: parseValue(allPodsRows[12]?.[8]),
                        directConversionsMRR: parseValue(allPodsRows[13]?.[8]),
                        directConversionsDealPoints: parseValue(allPodsRows[14]?.[8]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    },
                    {
                        name: 'Misc Pod (Total)',
                        icon: 'untracked',
                        short: 'UT',
                        pod: 'Untracked',
                        spend: parseValue(allPodsRows[1]?.[10]),
                        accounts: parseValue(allPodsRows[2]?.[10]),
                        demos: parseValue(allPodsRows[3]?.[10]),
                        deals: parseValue(allPodsRows[4]?.[10]),
                        dealPoints: parseValue(allPodsRows[5]?.[10]),
                        generatedMRR: parseValue(allPodsRows[10]?.[10]),
                        closedMRR: parseValue(allPodsRows[11]?.[10]),
                        directConversions: parseValue(allPodsRows[12]?.[10]),
                        directConversionsMRR: parseValue(allPodsRows[13]?.[10]),
                        directConversionsDealPoints: parseValue(allPodsRows[14]?.[10]),
                        cpc: 0, clicks: 0, impressions: 0, ctr: 0
                    }
                ];

                // Parse Conversion Pod channels
                const conversionChannels = [];
                if (conversionRows && conversionRows.length > 0) {
                    const group1Names = ['Google Search Ads', 'Bing Search Ads', 'Reddit Ads', 'LinkedIn Ads', 'Facebook Ads'];
                    const group1Icons = ['google', 'bing', 'reddit', 'linkedin', 'facebook'];
                    const group1Shorts = ['G', 'B', 'R', 'in', 'f'];
                    
                    group1Names.forEach((name, idx) => {
                        const colOffset = idx * 3 + 3;
                        conversionChannels.push({
                            name,
                            icon: group1Icons[idx],
                            short: group1Shorts[idx],
                            pod: 'Conversion',
                            spend: parseValue(conversionRows[18]?.[colOffset]),
                            accounts: parseValue(conversionRows[19]?.[colOffset]),
                            demos: parseValue(conversionRows[20]?.[colOffset]),
                            deals: parseValue(conversionRows[21]?.[colOffset]),
                            dealPoints: parseValue(conversionRows[22]?.[colOffset]),
                            generatedMRR: parseValue(conversionRows[27]?.[colOffset]),
                            closedMRR: parseValue(conversionRows[28]?.[colOffset]),
                            directConversions: parseValue(conversionRows[29]?.[colOffset]),
                            directConversionsMRR: parseValue(conversionRows[30]?.[colOffset]),
                            directConversionsDealPoints: parseValue(conversionRows[31]?.[colOffset]),
                            cpc: parseValue(conversionRows[32]?.[colOffset]),
                            clicks: parseValue(conversionRows[33]?.[colOffset]),
                            impressions: parseValue(conversionRows[34]?.[colOffset]),
                            ctr: parseValue(conversionRows[35]?.[colOffset])
                        });
                    });

                    const group2Names = ['Microsoft Display Ads', 'YouTube Ads', 'Capterra CPC', 'RevLeads CPC', 'Select Software Reviews'];
                    const group2Icons = ['microsoft', 'youtube', 'capterra', 'revleads', 'selectsoftware'];
                    const group2Shorts = ['M', '▶', 'C', 'R', 'S'];
                    
                    group2Names.forEach((name, idx) => {
                        const colOffset = idx * 3 + 3;
                        conversionChannels.push({
                            name,
                            icon: group2Icons[idx],
                            short: group2Shorts[idx],
                            pod: 'Conversion',
                            spend: parseValue(conversionRows[38]?.[colOffset]),
                            accounts: parseValue(conversionRows[39]?.[colOffset]),
                            demos: parseValue(conversionRows[40]?.[colOffset]),
                            deals: parseValue(conversionRows[41]?.[colOffset]),
                            dealPoints: parseValue(conversionRows[42]?.[colOffset]),
                            generatedMRR: parseValue(conversionRows[47]?.[colOffset]),
                            closedMRR: parseValue(conversionRows[48]?.[colOffset]),
                            directConversions: parseValue(conversionRows[49]?.[colOffset]),
                            directConversionsMRR: parseValue(conversionRows[50]?.[colOffset]),
                            directConversionsDealPoints: parseValue(conversionRows[51]?.[colOffset]),
                            cpc: parseValue(conversionRows[52]?.[colOffset]),
                            clicks: parseValue(conversionRows[53]?.[colOffset]),
                            impressions: parseValue(conversionRows[54]?.[colOffset]),
                            ctr: parseValue(conversionRows[55]?.[colOffset])
                        });
                    });

                    const group3Names = ['Forbes CPL', 'Capterra CPL', 'Outbound - MQL Data', 'Outbound - Cold Data', 'Affiliate', 'Email'];
                    const group3Icons = ['forbes', 'capterracpl', 'outboundmql', 'outboundcold', 'affiliate', 'email'];
                    const group3Shorts = ['F', 'C', 'M', 'O', 'A', 'E'];
                    
                    group3Names.forEach((name, idx) => {
                        const colOffset = idx * 3 + 3;
                        conversionChannels.push({
                            name,
                            icon: group3Icons[idx],
                            short: group3Shorts[idx],
                            pod: 'Conversion',
                            spend: parseValue(conversionRows[58]?.[colOffset]),
                            accounts: parseValue(conversionRows[59]?.[colOffset]),
                            demos: parseValue(conversionRows[60]?.[colOffset]),
                            deals: parseValue(conversionRows[61]?.[colOffset]),
                            dealPoints: parseValue(conversionRows[62]?.[colOffset]),
                            generatedMRR: parseValue(conversionRows[67]?.[colOffset]),
                            closedMRR: parseValue(conversionRows[68]?.[colOffset]),
                            directConversions: parseValue(conversionRows[69]?.[colOffset]),
                            directConversionsMRR: parseValue(conversionRows[70]?.[colOffset]),
                            directConversionsDealPoints: parseValue(conversionRows[71]?.[colOffset]),
                            cpc: parseValue(conversionRows[72]?.[colOffset]),
                            clicks: parseValue(conversionRows[73]?.[colOffset]),
                            impressions: parseValue(conversionRows[74]?.[colOffset]),
                            ctr: parseValue(conversionRows[75]?.[colOffset])
                        });
                    });
                }

                // Parse Brand Advocacy Pod channels
                const brandChannels = [];
                if (brandRows && brandRows.length > 0) {
                    const brandNames = ['G2 Sponsored', 'Capterra PPL', 'GetApp PPL', 'Software Advice', 'G2 Buyer Intent'];
                    const brandIcons = ['g2', 'capterra', 'getapp', 'softwareadvice', 'g2intent'];
                    const brandShorts = ['G2', 'CT', 'GA', 'SA', 'BI'];
                    
                    brandNames.forEach((name, idx) => {
                        const colOffset = idx * 3 + 3;
                        brandChannels.push({
                            name,
                            icon: brandIcons[idx],
                            short: brandShorts[idx],
                            pod: 'Brand',
                            spend: parseValue(brandRows[18]?.[colOffset]),
                            accounts: parseValue(brandRows[19]?.[colOffset]),
                            demos: parseValue(brandRows[20]?.[colOffset]),
                            deals: parseValue(brandRows[21]?.[colOffset]),
                            dealPoints: parseValue(brandRows[22]?.[colOffset]),
                            generatedMRR: parseValue(brandRows[27]?.[colOffset]),
                            closedMRR: parseValue(brandRows[28]?.[colOffset]),
                            directConversions: parseValue(brandRows[29]?.[colOffset]),
                            directConversionsMRR: parseValue(brandRows[30]?.[colOffset]),
                            directConversionsDealPoints: parseValue(brandRows[31]?.[colOffset]),
                            cpc: 0, clicks: 0, impressions: 0, ctr: 0
                        });
                    });
                }

                // Parse Awareness Pod channels
                const awarenessChannels = [];
                if (awarenessRows && awarenessRows.length > 0) {
                    const awarenessNames = ['Google Display', 'Facebook Awareness', 'LinkedIn Awareness', 'YouTube Awareness', 'Twitter/X Ads'];
                    const awarenessIcons = ['google', 'facebook', 'linkedin', 'youtube', 'twitter'];
                    const awarenessShorts = ['GD', 'FA', 'LA', 'YA', 'X'];
                    
                    awarenessNames.forEach((name, idx) => {
                        const colOffset = idx * 3 + 3;
                        awarenessChannels.push({
                            name,
                            icon: awarenessIcons[idx],
                            short: awarenessShorts[idx],
                            pod: 'Awareness',
                            spend: parseValue(awarenessRows[18]?.[colOffset]),
                            accounts: parseValue(awarenessRows[19]?.[colOffset]),
                            demos: parseValue(awarenessRows[20]?.[colOffset]),
                            deals: parseValue(awarenessRows[21]?.[colOffset]),
                            dealPoints: parseValue(awarenessRows[22]?.[colOffset]),
                            generatedMRR: parseValue(awarenessRows[27]?.[colOffset]),
                            closedMRR: parseValue(awarenessRows[28]?.[colOffset]),
                            directConversions: parseValue(awarenessRows[29]?.[colOffset]),
                            directConversionsMRR: parseValue(awarenessRows[30]?.[colOffset]),
                            directConversionsDealPoints: parseValue(awarenessRows[31]?.[colOffset]),
                            cpc: 0, clicks: 0, impressions: 0, ctr: 0
                        });
                    });
                }

                // Combine all channels with pod totals first, then individual channels
                const allChannels = [
                    ...podChannels,
                    ...conversionChannels,
                    ...brandChannels,
                    ...awarenessChannels
                ];

                return { summary, weeks, channels: allChannels, podChannels, month: 'All Time' };
            };

            const getEmptyData = (month) => ({
                summary: { spend: 0, accounts: 0, demos: 0, deals: 0, dealPoints: 0, generatedMRR: 0, closedMRR: 0, directConversions: 0, directConversionsMRR: 0, directConversionsDealPoints: 0 },
                weeks: WEEKS.map(week => ({ label: week, dates: WEEK_DATES[week], spend: 0, accounts: 0, demos: 0, deals: 0, dealPoints: 0, generatedMRR: 0, closedMRR: 0, directConversions: 0, directConversionsMRR: 0, directConversionsDealPoints: 0 })),
                channels: [],
                month
            });

            const fetchMonthData = async (month, spreadsheetId, podKey) => {
                try {
                    // Determine the correct range/tab name based on pod
                    let range;
                    if (podKey === 'all') {
                        range = 'Overview!A1:O35';
                    } else if (podKey === 'outbound') {
                        // Outbound uses "January 2026" format for tabs
                        range = `${month} 2026!A1:AZ100`;
                    } else {
                        range = `${month}!A1:AZ100`;
                    }
                    
                    const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${encodeURIComponent(range)}?key=${API_KEY}`;
                    const response = await fetch(url);
                    
                    if (!response.ok) {
                        if (response.status === 400) return null; // Sheet doesn't exist
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    const result = await response.json();
                    // Use appropriate parser based on pod
                    if (podKey === 'all') {
                        return processAllPodsData(result.values, month);
                    } else if (podKey === 'brand') {
                        return processBrandAdvocacyData(result.values, month);
                    } else if (podKey === 'awareness') {
                        return processAwarenessData(result.values, month);
                    } else if (podKey === 'outbound') {
                        return processOutboundData(result.values, month);
                    }
                    return processSheetData(result.values, month);
                } catch (err) {
                    console.error(`Error fetching ${month}:`, err);
                    return null;
                }
            };

            const checkAvailableMonths = async (spreadsheetId, podKey) => {
                const available = [];
                for (const month of MONTHS) {
                    try {
                        // Outbound uses "January 2026" format, others use "January"
                        const tabName = podKey === 'outbound' ? `${month.key} 2026` : month.key;
                        const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${encodeURIComponent(tabName)}!A1:A1?key=${API_KEY}`;
                        const response = await fetch(url);
                        if (response.ok) available.push(month.key);
                    } catch (err) { /* Month doesn't exist */ }
                }
                return available.length > 0 ? available : ['January'];
            };

            // Fetch Leadership data from all pods
            const fetchLeadershipData = async () => {
                try {
                    // Fetch All Pods overview
                    const allPodsUrl = `https://sheets.googleapis.com/v4/spreadsheets/${POD_SPREADSHEETS.all}/values/Overview!A1:O35?key=${API_KEY}`;
                    const allPodsResponse = await fetch(allPodsUrl);
                    const allPodsResult = allPodsResponse.ok ? await allPodsResponse.json() : { values: [] };

                    // Fetch January data from each pod to get all-time channel totals
                    const conversionUrl = `https://sheets.googleapis.com/v4/spreadsheets/${POD_SPREADSHEETS.conversion}/values/January!A1:AZ100?key=${API_KEY}`;
                    const brandUrl = `https://sheets.googleapis.com/v4/spreadsheets/${POD_SPREADSHEETS.brand}/values/January!A1:AZ100?key=${API_KEY}`;
                    const awarenessUrl = `https://sheets.googleapis.com/v4/spreadsheets/${POD_SPREADSHEETS.awareness}/values/January!A1:AZ100?key=${API_KEY}`;

                    const [conversionResp, brandResp, awarenessResp] = await Promise.all([
                        fetch(conversionUrl),
                        fetch(brandUrl),
                        fetch(awarenessUrl)
                    ]);

                    const conversionResult = conversionResp.ok ? await conversionResp.json() : { values: [] };
                    const brandResult = brandResp.ok ? await brandResp.json() : { values: [] };
                    const awarenessResult = awarenessResp.ok ? await awarenessResp.json() : { values: [] };

                    return processLeadershipData(
                        allPodsResult.values || [],
                        conversionResult.values || [],
                        brandResult.values || [],
                        awarenessResult.values || []
                    );
                } catch (err) {
                    console.error('Error fetching leadership data:', err);
                    return null;
                }
            };

            // Aggregate all months data for Overview
            const aggregateMonthsData = (monthsData) => {
                const allMonths = Object.values(monthsData);
                if (allMonths.length === 0) return getEmptyData('Overview');

                const summary = {
                    spend: allMonths.reduce((sum, m) => sum + (m.summary?.spend || 0), 0),
                    accounts: allMonths.reduce((sum, m) => sum + (m.summary?.accounts || 0), 0),
                    demos: allMonths.reduce((sum, m) => sum + (m.summary?.demos || 0), 0),
                    deals: allMonths.reduce((sum, m) => sum + (m.summary?.deals || 0), 0),
                    dealPoints: allMonths.reduce((sum, m) => sum + (m.summary?.dealPoints || 0), 0),
                    generatedMRR: allMonths.reduce((sum, m) => sum + (m.summary?.generatedMRR || 0), 0),
                    closedMRR: allMonths.reduce((sum, m) => sum + (m.summary?.closedMRR || 0), 0),
                    directConversions: allMonths.reduce((sum, m) => sum + (m.summary?.directConversions || 0), 0),
                    directConversionsMRR: allMonths.reduce((sum, m) => sum + (m.summary?.directConversionsMRR || 0), 0),
                    directConversionsDealPoints: allMonths.reduce((sum, m) => sum + (m.summary?.directConversionsDealPoints || 0), 0)
                };

                // Create monthly trend for the weeks section (showing each month as a data point)
                const weeks = allMonths.map((m, idx) => ({
                    label: MONTHS[idx]?.short || `M${idx + 1}`,
                    dates: `${MONTHS[idx]?.label || 'Month'} 2026`,
                    spend: m.summary?.spend || 0,
                    accounts: m.summary?.accounts || 0,
                    demos: m.summary?.demos || 0,
                    deals: m.summary?.deals || 0,
                    dealPoints: m.summary?.dealPoints || 0,
                    generatedMRR: m.summary?.generatedMRR || 0,
                    closedMRR: m.summary?.closedMRR || 0,
                    directConversions: m.summary?.directConversions || 0,
                    directConversionsMRR: m.summary?.directConversionsMRR || 0,
                    directConversionsDealPoints: m.summary?.directConversionsDealPoints || 0
                }));

                // Aggregate channels
                const channelMap = {};
                allMonths.forEach(m => {
                    (m.channels || []).forEach(ch => {
                        if (!channelMap[ch.name]) {
                            channelMap[ch.name] = { ...ch };
                        } else {
                            channelMap[ch.name].spend += ch.spend || 0;
                            channelMap[ch.name].accounts += ch.accounts || 0;
                            channelMap[ch.name].demos += ch.demos || 0;
                            channelMap[ch.name].deals += ch.deals || 0;
                            channelMap[ch.name].dealPoints += ch.dealPoints || 0;
                            channelMap[ch.name].generatedMRR += ch.generatedMRR || 0;
                            channelMap[ch.name].closedMRR += ch.closedMRR || 0;
                            channelMap[ch.name].directConversions += ch.directConversions || 0;
                            channelMap[ch.name].directConversionsMRR += ch.directConversionsMRR || 0;
                            channelMap[ch.name].directConversionsDealPoints += ch.directConversionsDealPoints || 0;
                            channelMap[ch.name].clicks += ch.clicks || 0;
                            channelMap[ch.name].impressions += ch.impressions || 0;
                        }
                    });
                });

                return { summary, weeks, channels: Object.values(channelMap), month: 'Overview' };
            };

            const fetchAllData = async (podKey = selectedPod) => {
                const spreadsheetId = POD_SPREADSHEETS[podKey];
                if (!spreadsheetId) {
                    // No spreadsheet configured for this pod
                    setData({});
                    setAvailableMonths(['January']);
                    setLoading(false);
                    return;
                }

                setRefreshing(true);
                try {
                    // Leadership pod - fetch aggregated all-time data from all pods
                    if (podKey === 'leadership') {
                        const leadershipData = await fetchLeadershipData();
                        setAvailableMonths(['All Time']);
                        setSelectedMonth('All Time');
                        setData({ 'All Time': leadershipData || getEmptyData('All Time') });
                    }
                    // All Pods uses Overview tab, not monthly tabs
                    else if (podKey === 'all') {
                        const overviewData = await fetchMonthData('Overview', spreadsheetId, podKey);
                        setAvailableMonths(['All Time']);
                        setSelectedMonth('All Time');
                        setData({ 'All Time': overviewData || getEmptyData('All Time') });
                    } else {
                        const available = await checkAvailableMonths(spreadsheetId, podKey);
                    setAvailableMonths(available);

                    const allData = {};
                    for (const month of available) {
                            const monthData = await fetchMonthData(month, spreadsheetId, podKey);
                        if (monthData) allData[month] = monthData;
                    }

                    if (Object.keys(allData).length === 0) {
                        allData['January'] = getEmptyData('January');
                    }

                        // Create Overview aggregation
                        allData['Overview'] = aggregateMonthsData(allData);

                    setData(allData);
                        // Default to Overview when switching pods
                        if (selectedMonth !== 'Overview' && !available.includes(selectedMonth)) {
                            setSelectedMonth('Overview');
                        }
                    }
                    
                    const now = new Date();
                    setLastUpdated(now);
                    setNextRefresh(new Date(now.getTime() + 60 * 60 * 1000)); // 1 hour from now
                    setError(null);
                    showToast('Data refreshed successfully');
                } catch (err) {
                    console.error('Error:', err);
                    setError(err.message);
                    showToast('Failed to fetch data: ' + err.message, true);
                } finally {
                    setLoading(false);
                    setRefreshing(false);
                }
            };

            // Fetch data when pod changes
            useEffect(() => {
                if (POD_SPREADSHEETS[selectedPod]) {
                    setLoading(true);
                    // Default to Overview for pods with monthly data
                    if (selectedPod !== 'leadership' && selectedPod !== 'all') {
                        setSelectedMonth('Overview');
                    }
                    fetchAllData(selectedPod);
                }
            }, [selectedPod]);

            // Initial fetch and auto-refresh every 1 hour
            useEffect(() => {
                fetchAllData();
                
                // Set up auto-refresh interval (1 hour = 3600000 ms)
                const refreshInterval = setInterval(() => {
                    console.log('Auto-refreshing data...');
                    fetchAllData(selectedPod);
                }, 60 * 60 * 1000); // 1 hour
                
                // Cleanup on unmount
                return () => clearInterval(refreshInterval);
            }, []);

            // Countdown timer for next refresh
            useEffect(() => {
                if (!nextRefresh) return;
                
                const updateCountdown = () => {
                    const now = new Date();
                    const diff = nextRefresh.getTime() - now.getTime();
                    
                    if (diff <= 0) {
                        setCountdown('Refreshing...');
                        return;
                    }
                    
                    const minutes = Math.floor(diff / 60000);
                    const seconds = Math.floor((diff % 60000) / 1000);
                    setCountdown(`${minutes}m ${seconds}s`);
                };
                
                updateCountdown();
                const countdownInterval = setInterval(updateCountdown, 1000);
                
                return () => clearInterval(countdownInterval);
            }, [nextRefresh]);

            const currentData = useMemo(() => data[selectedMonth] || getEmptyData(selectedMonth), [data, selectedMonth]);

            const filteredChannels = useMemo(() => {
                let channels = currentData.channels || [];
                if (searchTerm) {
                    channels = channels.filter(ch => ch.name.toLowerCase().includes(searchTerm.toLowerCase()));
                }
                return [...channels].sort((a, b) => {
                    const aVal = a[sortConfig.key] || 0;
                    const bVal = b[sortConfig.key] || 0;
                    return sortConfig.direction === 'asc' ? aVal - bVal : bVal - aVal;
                });
            }, [currentData, searchTerm, sortConfig]);

            const displaySummary = useMemo(() => currentData.summary, [currentData]);

            // Charts
            useEffect(() => {
                if (!currentData.channels?.length || !trendChartRef.current || !channelChartRef.current) return;

                if (trendChartInstance.current) trendChartInstance.current.destroy();
                if (channelChartInstance.current) channelChartInstance.current.destroy();

                const metricConfig = CHART_METRICS.find(m => m.key === chartMetric) || CHART_METRICS[0];
                const isCurrency = metricConfig.format === 'currency';

                // Bar chart for channel performance (dynamic metric)
                const trendCtx = trendChartRef.current.getContext('2d');
                const topChannels = [...currentData.channels].sort((a, b) => (b[chartMetric] || 0) - (a[chartMetric] || 0)).slice(0, 8);
                
                trendChartInstance.current = new Chart(trendCtx, {
                    type: 'bar',
                    data: {
                        labels: topChannels.map(c => c.name.replace(' Ads', '').replace(' CPC', '').replace(' CPL', '')),
                        datasets: [{
                            label: metricConfig.label,
                            data: topChannels.map(c => c[chartMetric] || 0),
                            backgroundColor: '#2563eb',
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { grid: { display: false }, ticks: { color: '#64748b', font: { size: 11 } } },
                            y: { grid: { color: '#f1f5f9' }, ticks: { color: '#64748b', callback: v => isCurrency ? '$' + v : v } }
                        }
                    }
                });

                // Weekly trend line chart
                const channelCtx = channelChartRef.current.getContext('2d');
                const weeks = currentData.weeks || [];
                
                channelChartInstance.current = new Chart(channelCtx, {
                    type: 'line',
                    data: {
                        labels: weeks.map(w => w.label),
                        datasets: [
                            {
                                label: 'Spend',
                                data: weeks.map(w => w.spend),
                                borderColor: '#2563eb',
                                backgroundColor: 'rgba(37, 99, 235, 0.1)',
                                fill: true,
                                tension: 0.3,
                                pointRadius: 4,
                                pointBackgroundColor: '#2563eb'
                            },
                            {
                                label: 'Gen. MRR',
                                data: weeks.map(w => w.generatedMRR),
                                borderColor: '#059669',
                                backgroundColor: 'rgba(5, 150, 105, 0.1)',
                                fill: false,
                                tension: 0.3,
                                pointRadius: 4,
                                pointBackgroundColor: '#059669'
                            },
                            {
                                label: 'Demos',
                                data: weeks.map(w => w.demos),
                                borderColor: '#d97706',
                                backgroundColor: 'rgba(217, 119, 6, 0.1)',
                                fill: false,
                                tension: 0.3,
                                pointRadius: 4,
                                pointBackgroundColor: '#d97706',
                                yAxisID: 'y1'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: { mode: 'index', intersect: false },
                        plugins: {
                            legend: { position: 'top', labels: { color: '#475569', padding: 12, usePointStyle: true, font: { size: 11 } } }
                        },
                        scales: {
                            x: { grid: { display: false }, ticks: { color: '#64748b', font: { size: 11 } } },
                            y: { grid: { color: '#f1f5f9' }, ticks: { color: '#64748b', callback: v => '$' + v }, position: 'left' },
                            y1: { grid: { display: false }, ticks: { color: '#d97706' }, position: 'right' }
                        }
                    }
                });

                return () => {
                    if (trendChartInstance.current) trendChartInstance.current.destroy();
                    if (channelChartInstance.current) channelChartInstance.current.destroy();
                };
            }, [currentData, chartMetric]);

            const handleSort = (key) => {
                setSortConfig(prev => ({
                    key,
                    direction: prev.key === key && prev.direction === 'desc' ? 'asc' : 'desc'
                }));
            };

            if (loading) {
                return (
                    <div className="loading-overlay">
                        <div className="loading-spinner"></div>
                        <div className="loading-text">Loading dashboard...</div>
                    </div>
                );
            }

            const costPerAccount = displaySummary.accounts > 0 ? displaySummary.spend / displaySummary.accounts : 0;
            const costPerDemo = displaySummary.demos > 0 ? displaySummary.spend / displaySummary.demos : 0;
            const costPerDeal = displaySummary.deals > 0 ? displaySummary.spend / displaySummary.deals : 0;
            const costPerDealPoint = displaySummary.dealPoints > 0 ? displaySummary.spend / displaySummary.dealPoints : 0;

            return (
                <div className="layout">
                    <aside className="sidebar">
                        <div className="sidebar-header">
                            <div className="logo-section">
                                <div className="logo">R</div>
                                <div>
                                    <div className="logo-text">RecruitCRM</div>
                                    <div className="logo-subtitle">Media Dashboard</div>
                                </div>
                            </div>
                        </div>
                        
                        <div className="sidebar-content">
                            <div className="sidebar-section">
                                <div className="sidebar-section-title">Pods</div>
                                <div className="pod-list">
                                    {PODS.map(pod => (
                                            <button
                                            key={pod.key}
                                            className={`pod-item ${selectedPod === pod.key ? 'active' : ''}`}
                                            onClick={() => setSelectedPod(pod.key)}
                                        >
                                            <div className={`pod-icon ${pod.iconClass}`}>
                                                {Icons[pod.icon]}
                                            </div>
                                            <span>{pod.label}</span>
                                            </button>
                                    ))}
                                </div>
                            </div>

                        </div>

                        <div className="sidebar-footer">
                            <div className="connection-status">
                                <div className={`status-indicator ${error ? 'error' : refreshing ? 'loading' : ''}`}></div>
                                <span>{error ? 'Error' : refreshing ? 'Syncing...' : 'Connected'}</span>
                            </div>
                            <div className="refresh-info">
                                <div className="refresh-row">
                                    <span className="refresh-label">Last Updated</span>
                                    <span className="refresh-value">{lastUpdated ? lastUpdated.toLocaleTimeString() : '—'}</span>
                                </div>
                                <div className="refresh-row">
                                    <span className="refresh-label">Next Refresh</span>
                                    <span className="refresh-value refresh-countdown">{countdown || '—'}</span>
                                </div>
                            </div>
                            <button className="refresh-btn" onClick={fetchAllData} disabled={refreshing}>
                                <span className={refreshing ? 'spinning' : ''}>{Icons.refresh}</span>
                                {refreshing ? 'Refreshing...' : 'Refresh Now'}
                            </button>
                        </div>
                    </aside>

                    <main className="main-content">
                        <div className="topbar">
                            <div className="page-title">{PODS.find(p => p.key === selectedPod)?.label}</div>
                            <div className="topbar-right">
                                <button className={`btn-icon ${refreshing ? 'spinning' : ''}`} onClick={() => fetchAllData(selectedPod)} disabled={refreshing} title="Refresh data">
                                    {Icons.refresh}
                                </button>
                            </div>
                        </div>

                        {/* Period Tabs - Only show for pods with monthly data */}
                        {POD_SPREADSHEETS[selectedPod] && selectedPod !== 'leadership' && selectedPod !== 'all' && (
                            <div className="period-tabs">
                                <button
                                    className={`period-tab overview ${selectedMonth === 'Overview' ? 'active' : ''}`}
                                    onClick={() => setSelectedMonth('Overview')}
                                >
                                    <span className="period-tab-icon">{Icons.globe}</span>
                                    Overview
                                </button>
                                {MONTHS.map(month => {
                                    const hasData = availableMonths.includes(month.key);
                                    return (
                                        <button
                                            key={month.key}
                                            className={`period-tab ${selectedMonth === month.key ? 'active' : ''} ${!hasData ? 'disabled' : ''}`}
                                            onClick={() => hasData && setSelectedMonth(month.key)}
                                            disabled={!hasData}
                                        >
                                            {month.short}
                                            {hasData && <span className="status-dot"></span>}
                                        </button>
                                    );
                                })}
                            </div>
                        )}

                        {selectedPod === 'leadership' && currentData.channels ? (
                        <>
                        <div className="filter-bar">
                            <div className="leadership-header">
                                <div className="leadership-title">All-Time Performance Overview</div>
                            </div>
                            <div style={{flex: 1}}></div>
                            {lastUpdated && <span className="filter-label">Updated: {lastUpdated.toLocaleTimeString()}</span>}
                        </div>

                        <div className="content-area">
                            {/* All-Time Summary Metrics */}
                            <div className="leadership-section">
                                <div className="leadership-section-title">All-Time Totals (All Pods Combined)</div>
                            <div className="summary-grid">
                                <div className="summary-card">
                                    <div className="summary-icon spend">{Icons.dollar}</div>
                                        <div className="summary-label">Spend</div>
                                    <div className="summary-value">{formatCurrency(displaySummary.spend)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon accounts">{Icons.users}</div>
                                    <div className="summary-label">Accounts</div>
                                    <div className="summary-value">{formatNumber(displaySummary.accounts)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon demos">{Icons.calendar}</div>
                                    <div className="summary-label">Demos</div>
                                    <div className="summary-value">{formatNumber(displaySummary.demos)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon deals">{Icons.target}</div>
                                    <div className="summary-label">Deals</div>
                                    <div className="summary-value">{formatNumber(displaySummary.deals)}</div>
                                </div>
                                    <div className="summary-card">
                                        <div className="summary-icon dealpoints">{Icons.star}</div>
                                        <div className="summary-label">Deal Points</div>
                                        <div className="summary-value">{formatNumber(displaySummary.dealPoints)}</div>
                                    </div>
                                    <div className="summary-card">
                                        <div className="summary-icon cpaccount">{Icons.percent}</div>
                                        <div className="summary-label">Cost Per Account</div>
                                        <div className="summary-value">{formatCurrency(costPerAccount)}</div>
                                    </div>
                                    <div className="summary-card">
                                        <div className="summary-icon cpa">{Icons.percent}</div>
                                        <div className="summary-label">Cost Per Demo</div>
                                        <div className="summary-value">{formatCurrency(costPerDemo)}</div>
                                    </div>
                                    <div className="summary-card">
                                        <div className="summary-icon cpdeal">{Icons.percent}</div>
                                        <div className="summary-label">Cost Per Deal</div>
                                        <div className="summary-value">{formatCurrency(costPerDeal)}</div>
                                    </div>
                                    <div className="summary-card">
                                        <div className="summary-icon cpdealpt">{Icons.percent}</div>
                                        <div className="summary-label">Cost Per Deal Point</div>
                                        <div className="summary-value">{formatCurrency(costPerDealPoint)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon mrr">{Icons.trending}</div>
                                    <div className="summary-label">Generated MRR</div>
                                    <div className="summary-value">{formatCurrency(displaySummary.generatedMRR)}</div>
                                    </div>
                                    <div className="summary-card">
                                        <div className="summary-icon closedmrr">{Icons.check}</div>
                                        <div className="summary-label">Closed MRR</div>
                                        <div className="summary-value">{formatCurrency(displaySummary.closedMRR)}</div>
                                    </div>
                                    <div className="summary-card">
                                        <div className="summary-icon directconv">{Icons.arrowUp}</div>
                                        <div className="summary-label">Direct Conversions</div>
                                        <div className="summary-value">{formatNumber(displaySummary.directConversions)}</div>
                                    </div>
                                    <div className="summary-card">
                                        <div className="summary-icon directmrr">{Icons.award}</div>
                                        <div className="summary-label">Direct Conv. MRR</div>
                                        <div className="summary-value">{formatCurrency(displaySummary.directConversionsMRR)}</div>
                                    </div>
                                    <div className="summary-card">
                                        <div className="summary-icon directdp">{Icons.star}</div>
                                        <div className="summary-label">Direct Conv. Deal Pts</div>
                                        <div className="summary-value">{formatNumber(displaySummary.directConversionsDealPoints)}</div>
                                    </div>
                                </div>
                            </div>

                            {/* Pod Breakdown */}
                            <div className="leadership-section">
                                <div className="leadership-section-title">Pod Performance Breakdown</div>
                                <div className="pod-totals-grid">
                                    {currentData.channels?.filter(ch => ch.name.includes('(Total)')).map((pod, idx) => (
                                        <div key={idx} className={`pod-total-card ${pod.icon}`}>
                                            <div className="pod-total-header">
                                                <div className={`pod-total-icon ${pod.icon}`}>
                                                    {Icons[pod.icon === 'awareness' ? 'eye' : pod.icon === 'brand' ? 'heart' : pod.icon === 'conversion' ? 'zap' : 'help']}
                                                </div>
                                                <div className="pod-total-name">{pod.name.replace(' (Total)', '')}</div>
                                            </div>
                                            <div className="pod-total-metrics">
                                                <div className="pod-metric">
                                                    <div className="pod-metric-label">Spend</div>
                                                    <div className="pod-metric-value">{formatCurrency(pod.spend)}</div>
                                                </div>
                                                <div className="pod-metric">
                                                    <div className="pod-metric-label">Deals</div>
                                                    <div className="pod-metric-value">{formatNumber(pod.deals)}</div>
                                                </div>
                                                <div className="pod-metric">
                                                    <div className="pod-metric-label">Deal Points</div>
                                                    <div className="pod-metric-value">{formatNumber(pod.dealPoints)}</div>
                                                </div>
                                                <div className="pod-metric">
                                                    <div className="pod-metric-label">Gen. MRR</div>
                                                    <div className="pod-metric-value">{formatCurrency(pod.generatedMRR)}</div>
                                                </div>
                                                <div className="pod-metric">
                                                    <div className="pod-metric-label">Closed MRR</div>
                                                    <div className="pod-metric-value">{formatCurrency(pod.closedMRR)}</div>
                                                </div>
                                                <div className="pod-metric">
                                                    <div className="pod-metric-label">Dir. Conv.</div>
                                                    <div className="pod-metric-value">{formatNumber(pod.directConversions)}</div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* Monthly Trend Charts */}
                            <div className="charts-grid">
                                <div className="chart-card">
                                    <div className="chart-header">
                                        <div className="chart-title">Monthly Performance by Pod</div>
                                        <div className="chart-controls">
                                            <select className="chart-metric-select" value={chartMetric} onChange={(e) => setChartMetric(e.target.value)}>
                                                {CHART_METRICS.map(m => <option key={m.key} value={m.key}>{m.label}</option>)}
                                            </select>
                                        </div>
                                    </div>
                                    <div className="chart-container">
                                        <canvas ref={trendChartRef}></canvas>
                                    </div>
                                </div>
                                <div className="chart-card">
                                    <div className="chart-header">
                                        <div className="chart-title">Monthly Trend</div>
                                    </div>
                                    <div className="chart-container">
                                        <canvas ref={channelChartRef}></canvas>
                                    </div>
                                </div>
                            </div>

                            {/* All Channels from All Pods Table */}
                            <div className="leadership-section">
                                <div className="leadership-section-title">All Channels (All Pods)</div>
                                <div className="table-card">
                                    <div className="table-header">
                                        <div className="table-title">Channel Performance by Pod</div>
                                        <input
                                            type="text"
                                            className="search-input"
                                            placeholder="Search channels..."
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                        />
                                    </div>
                                    <div style={{overflowX: 'auto'}}>
                                    <table className="data-table">
                                        <thead>
                                            <tr>
                                                <th onClick={() => handleSort('name')}>Channel</th>
                                                <th>Pod</th>
                                                <th onClick={() => handleSort('spend')}>Spend</th>
                                                <th onClick={() => handleSort('accounts')}>Accounts</th>
                                                <th onClick={() => handleSort('demos')}>Demos</th>
                                                <th onClick={() => handleSort('deals')}>Deals</th>
                                                <th onClick={() => handleSort('dealPoints')}>Deal Pts</th>
                                                <th>CPA</th>
                                                <th>CPD</th>
                                                <th onClick={() => handleSort('generatedMRR')}>Gen. MRR</th>
                                                <th onClick={() => handleSort('closedMRR')}>Closed MRR</th>
                                                <th onClick={() => handleSort('directConversions')}>Dir. Conv</th>
                                                <th onClick={() => handleSort('directConversionsMRR')}>Dir. MRR</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {filteredChannels.filter(ch => !ch.name.includes('(Total)')).map((channel, idx) => {
                                                const cpa = channel.accounts > 0 ? channel.spend / channel.accounts : 0;
                                                const cpd = channel.demos > 0 ? channel.spend / channel.demos : 0;
                                                return (
                                                    <tr key={idx}>
                                                        <td>
                                                            <div className="channel-cell">
                                                                <div className={`channel-icon ${channel.icon}`}>{channel.short}</div>
                                                                <span className="channel-name">{channel.name}</span>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <span className={`pod-badge ${channel.pod?.toLowerCase()}`}>
                                                                {channel.pod}
                                                            </span>
                                                        </td>
                                                        <td>{formatCurrency(channel.spend)}</td>
                                                        <td>{formatNumber(channel.accounts)}</td>
                                                        <td>{formatNumber(channel.demos)}</td>
                                                        <td>{formatNumber(channel.deals)}</td>
                                                        <td>{formatNumber(channel.dealPoints)}</td>
                                                        <td>{cpa > 0 ? formatCurrency(cpa) : '—'}</td>
                                                        <td>{cpd > 0 ? formatCurrency(cpd) : '—'}</td>
                                                        <td>{formatCurrency(channel.generatedMRR)}</td>
                                                        <td>{formatCurrency(channel.closedMRR)}</td>
                                                        <td>{formatNumber(channel.directConversions)}</td>
                                                        <td>{formatCurrency(channel.directConversionsMRR)}</td>
                                                    </tr>
                                                );
                                            })}
                                        </tbody>
                                    </table>
                                    </div>
                                </div>
                            </div>

                            {/* Monthly Cards */}
                            <div className="leadership-section">
                                <div className="leadership-section-title">Monthly Breakdown</div>
                                <div className="weekly-grid">
                                    {currentData.weeks?.map((week, idx) => {
                                        const prevWeek = idx > 0 ? currentData.weeks[idx - 1] : null;
                                        const renderMetric = (label, value, prevValue, isCurrency = false) => {
                                            const growth = prevWeek ? calcGrowth(value, prevValue) : null;
                                            return (
                                                <div className="week-metric">
                                                    <div className="week-metric-label">{label}</div>
                                                    <div className="week-metric-row">
                                                        <div className="week-metric-value">{isCurrency ? formatCurrency(value) : formatNumber(value)}</div>
                                                        {growth && growth.direction !== 'neutral' && (
                                                            <span className={`growth-indicator ${growth.direction}`}>
                                                                {growth.direction === 'up' ? Icons.trendUp : Icons.trendDown}
                                                                {growth.percent}%
                                                            </span>
                                                        )}
                                                    </div>
                                                </div>
                                            );
                                        };
                                        return (
                                        <div key={idx} className="week-card">
                                            <div className="week-card-header">
                                                <div className="week-label">{week.label}</div>
                                                <div className="week-dates">{week.dates}</div>
                                            </div>
                                            <div className="week-metrics">
                                                {renderMetric('Spend', week.spend, prevWeek?.spend, true)}
                                                {renderMetric('Accounts', week.accounts, prevWeek?.accounts)}
                                                {renderMetric('Demos', week.demos, prevWeek?.demos)}
                                                {renderMetric('Deals', week.deals, prevWeek?.deals)}
                                                {renderMetric('Deal Pts', week.dealPoints, prevWeek?.dealPoints)}
                                                {renderMetric('Gen. MRR', week.generatedMRR, prevWeek?.generatedMRR, true)}
                                                {renderMetric('Closed MRR', week.closedMRR, prevWeek?.closedMRR, true)}
                                                {renderMetric('Dir. Conv', week.directConversions, prevWeek?.directConversions)}
                                            </div>
                                        </div>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                        </>
                        ) : POD_SPREADSHEETS[selectedPod] ? (
                        <>
                        <div className="filter-bar">
                            <div className="filter-group">
                                <span className="filter-label" style={{fontWeight: 600, color: 'var(--text-primary)'}}>
                                    {selectedMonth === 'Overview' ? 'All-Time Overview' : `${selectedMonth} 2026`}
                                </span>
                            </div>
                            <div style={{flex: 1}}></div>
                            {lastUpdated && <span className="filter-label">Updated: {lastUpdated.toLocaleTimeString()}</span>}
                        </div>

                        <div className="content-area">
                            <div className="summary-grid">
                                <div className="summary-card">
                                    <div className="summary-icon spend">{Icons.dollar}</div>
                                    <div className="summary-label">Spend</div>
                                    <div className="summary-value">{formatCurrency(displaySummary.spend)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon accounts">{Icons.users}</div>
                                    <div className="summary-label">Accounts</div>
                                    <div className="summary-value">{formatNumber(displaySummary.accounts)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon demos">{Icons.calendar}</div>
                                    <div className="summary-label">Demos</div>
                                    <div className="summary-value">{formatNumber(displaySummary.demos)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon deals">{Icons.target}</div>
                                    <div className="summary-label">Deals</div>
                                    <div className="summary-value">{formatNumber(displaySummary.deals)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon dealpoints">{Icons.star}</div>
                                    <div className="summary-label">Deal Points</div>
                                    <div className="summary-value">{formatNumber(displaySummary.dealPoints)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon cpaccount">{Icons.percent}</div>
                                    <div className="summary-label">Cost Per Account</div>
                                    <div className="summary-value">{formatCurrency(costPerAccount)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon cpa">{Icons.percent}</div>
                                    <div className="summary-label">Cost Per Demo</div>
                                    <div className="summary-value">{formatCurrency(costPerDemo)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon cpdeal">{Icons.percent}</div>
                                    <div className="summary-label">Cost Per Deal</div>
                                    <div className="summary-value">{formatCurrency(costPerDeal)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon cpdealpt">{Icons.percent}</div>
                                    <div className="summary-label">Cost Per Deal Point</div>
                                    <div className="summary-value">{formatCurrency(costPerDealPoint)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon mrr">{Icons.trending}</div>
                                    <div className="summary-label">Generated MRR</div>
                                    <div className="summary-value">{formatCurrency(displaySummary.generatedMRR)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon closedmrr">{Icons.check}</div>
                                    <div className="summary-label">Closed MRR</div>
                                    <div className="summary-value">{formatCurrency(displaySummary.closedMRR)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon directconv">{Icons.arrowUp}</div>
                                    <div className="summary-label">Direct Conversions</div>
                                    <div className="summary-value">{formatNumber(displaySummary.directConversions)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon directmrr">{Icons.award}</div>
                                    <div className="summary-label">Direct Conv. MRR</div>
                                    <div className="summary-value">{formatCurrency(displaySummary.directConversionsMRR)}</div>
                                </div>
                                <div className="summary-card">
                                    <div className="summary-icon directdp">{Icons.star}</div>
                                    <div className="summary-label">Direct Conv. Deal Pts</div>
                                    <div className="summary-value">{formatNumber(displaySummary.directConversionsDealPoints)}</div>
                                </div>
                            </div>

                            <div className="charts-grid">
                                <div className="chart-card">
                                    <div className="chart-header">
                                        <div className="chart-title">Channel Performance</div>
                                        <div className="chart-controls">
                                            <select className="chart-metric-select" value={chartMetric} onChange={(e) => setChartMetric(e.target.value)}>
                                                {CHART_METRICS.map(m => <option key={m.key} value={m.key}>{m.label}</option>)}
                                            </select>
                                        </div>
                                    </div>
                                    <div className="chart-container">
                                        <canvas ref={trendChartRef}></canvas>
                                    </div>
                                </div>
                                <div className="chart-card">
                                    <div className="chart-header">
                                        <div className="chart-title">Weekly Trend</div>
                                    </div>
                                    <div className="chart-container">
                                        <canvas ref={channelChartRef}></canvas>
                                    </div>
                                </div>
                            </div>

                            <div className="table-card">
                                <div className="table-header">
                                    <div className="table-title">Channel Performance</div>
                                    <input
                                        type="text"
                                        className="search-input"
                                        placeholder="Search channels..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />
                                </div>
                                <div style={{overflowX: 'auto'}}>
                                <table className="data-table">
                                    <thead>
                                        <tr>
                                            <th onClick={() => handleSort('name')}>Channel</th>
                                            <th onClick={() => handleSort('spend')}>Spend</th>
                                            <th onClick={() => handleSort('accounts')}>Accounts</th>
                                            <th onClick={() => handleSort('demos')}>Demos</th>
                                            <th onClick={() => handleSort('deals')}>Deals</th>
                                            <th onClick={() => handleSort('dealPoints')}>Deal Pts</th>
                                            <th>CPA</th>
                                            <th>CPD</th>
                                            <th>CP Deal</th>
                                            <th>CP DP</th>
                                            <th onClick={() => handleSort('generatedMRR')}>Gen. MRR</th>
                                            <th onClick={() => handleSort('closedMRR')}>Closed MRR</th>
                                            <th onClick={() => handleSort('directConversions')}>Dir. Conv</th>
                                            <th onClick={() => handleSort('directConversionsMRR')}>Dir. MRR</th>
                                            <th onClick={() => handleSort('directConversionsDealPoints')}>Dir. DP</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {filteredChannels.map((channel, idx) => {
                                            const cpa = channel.accounts > 0 ? channel.spend / channel.accounts : 0;
                                            const cpd = channel.demos > 0 ? channel.spend / channel.demos : 0;
                                            const cpDeal = channel.deals > 0 ? channel.spend / channel.deals : 0;
                                            const cpDealPt = channel.dealPoints > 0 ? channel.spend / channel.dealPoints : 0;
                                            return (
                                                <tr key={idx}>
                                                    <td>
                                                        <div className="channel-cell">
                                                            <div className={`channel-icon ${channel.icon}`}>{channel.short}</div>
                                                            <span className="channel-name">{channel.name}</span>
                                                        </div>
                                                    </td>
                                                    <td>{formatCurrency(channel.spend)}</td>
                                                    <td>{formatNumber(channel.accounts)}</td>
                                                    <td>{formatNumber(channel.demos)}</td>
                                                    <td>{formatNumber(channel.deals)}</td>
                                                    <td>{formatNumber(channel.dealPoints)}</td>
                                                    <td>{cpa > 0 ? formatCurrency(cpa) : '—'}</td>
                                                    <td>{cpd > 0 ? formatCurrency(cpd) : '—'}</td>
                                                    <td>{cpDeal > 0 ? formatCurrency(cpDeal) : '—'}</td>
                                                    <td>{cpDealPt > 0 ? formatCurrency(cpDealPt) : '—'}</td>
                                                    <td>{formatCurrency(channel.generatedMRR)}</td>
                                                    <td>{formatCurrency(channel.closedMRR)}</td>
                                                    <td>{formatNumber(channel.directConversions)}</td>
                                                    <td>{formatCurrency(channel.directConversionsMRR)}</td>
                                                    <td>{formatNumber(channel.directConversionsDealPoints)}</td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                                </div>
                            </div>

                            <div className="weekly-grid">
                                {currentData.weeks?.map((week, idx) => {
                                    const prevWeek = idx > 0 ? currentData.weeks[idx - 1] : null;
                                    const renderMetric = (label, value, prevValue, isCurrency = false) => {
                                        const growth = prevWeek ? calcGrowth(value, prevValue) : null;
                                        return (
                                            <div className="week-metric">
                                                <div className="week-metric-label">{label}</div>
                                                <div className="week-metric-row">
                                                    <div className="week-metric-value">{isCurrency ? formatCurrency(value) : formatNumber(value)}</div>
                                                    {growth && growth.direction !== 'neutral' && (
                                                        <span className={`growth-indicator ${growth.direction}`}>
                                                            {growth.direction === 'up' ? Icons.trendUp : Icons.trendDown}
                                                            {growth.percent}%
                                                        </span>
                                                    )}
                                                </div>
                                            </div>
                                        );
                                    };
                                    return (
                                    <div key={idx} className={`week-card ${selectedWeek === week.label ? 'active' : ''}`} onClick={() => setSelectedWeek(week.label)}>
                                        <div className="week-card-header">
                                            <div className="week-label">{week.label}</div>
                                            <div className="week-dates">{week.dates}</div>
                                        </div>
                                        <div className="week-metrics">
                                                {renderMetric('Spend', week.spend, prevWeek?.spend, true)}
                                                {renderMetric('Accounts', week.accounts, prevWeek?.accounts)}
                                                {renderMetric('Demos', week.demos, prevWeek?.demos)}
                                                {renderMetric('Deals', week.deals, prevWeek?.deals)}
                                                {renderMetric('Deal Pts', week.dealPoints, prevWeek?.dealPoints)}
                                                {renderMetric('Gen. MRR', week.generatedMRR, prevWeek?.generatedMRR, true)}
                                                {renderMetric('Closed MRR', week.closedMRR, prevWeek?.closedMRR, true)}
                                                {renderMetric('Dir. Conv', week.directConversions, prevWeek?.directConversions)}
                                                {renderMetric('Dir. MRR', week.directConversionsMRR, prevWeek?.directConversionsMRR, true)}
                                                {renderMetric('Dir. DP', week.directConversionsDealPoints, prevWeek?.directConversionsDealPoints)}
                                            </div>
                                            </div>
                                    );
                                })}
                                            </div>

                            {/* SDR Section - Only for Outbound Pod */}
                            {selectedPod === 'outbound' && currentData.sdrs && currentData.sdrs.length > 0 && (
                                <div className="sdr-section">
                                    <div className="sdr-section-title">SDR Performance</div>
                                    <div className="table-card">
                                        <div className="table-header">
                                            <div className="table-title">Sales Development Representatives</div>
                                            </div>
                                        <div style={{overflowX: 'auto'}}>
                                        <table className="sdr-table">
                                            <thead>
                                                <tr>
                                                    <th>SDR Name</th>
                                                    <th>Demos</th>
                                                    <th>Deals</th>
                                                    <th>Deal Points</th>
                                                    <th>Accounts</th>
                                                    <th>Gen. MRR</th>
                                                    <th>Closed MRR</th>
                                                    <th>Dir. Conv.</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {currentData.sdrs.map((sdr, idx) => (
                                                    <tr key={idx}>
                                                        <td>
                                                            <div className="sdr-name-cell">
                                                                <div className="sdr-mini-avatar">
                                                                    {sdr.name.split(' ').map(n => n[0]).join('').slice(0, 2)}
                                        </div>
                                                                <span style={{fontWeight: 500}}>{sdr.name}</span>
                                    </div>
                                                        </td>
                                                        <td>{formatNumber(sdr.demos)}</td>
                                                        <td>{formatNumber(sdr.deals)}</td>
                                                        <td>{formatNumber(sdr.dealPoints)}</td>
                                                        <td>{formatNumber(sdr.accounts)}</td>
                                                        <td>{formatCurrency(sdr.generatedMRR)}</td>
                                                        <td>{formatCurrency(sdr.closedMRR)}</td>
                                                        <td>{formatNumber(sdr.directConversions)}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                            </div>
                        </div>
                                </div>
                            )}
                                            </div>
                        </>
                        ) : (
                        <div className="empty-state">
                            <div className="empty-state-icon">
                                {Icons[PODS.find(p => p.key === selectedPod)?.icon || 'grid']}
                                        </div>
                            <div className="empty-state-title">{PODS.find(p => p.key === selectedPod)?.label}</div>
                            <div className="empty-state-text">
                                This pod is not connected yet. Connect a Google Sheet to start tracking data for this pod.
                                    </div>
                            </div>
                        )}
                    </main>

                    {toast && <div className={`toast ${toast.isError ? 'error' : ''}`}>{Icons.check} {toast.message}</div>}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<Dashboard />);
    </script>
</body>
</html>
